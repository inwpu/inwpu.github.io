<!DOCTYPE html><html lang="zh-CN,en,default"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name="viewport"><meta name="description" content="看懂&#34;授时中心被黑&#34;的整件事：一条从手机到电脑的隐蔽渗透链"><meta name="hexo-theme-A4" content="v2.0.0"><link rel="alternate icon" type="image/webp" href="/img/favicon.png"><title>合安涵 | ❤️喜吾安璇</title><link rel="stylesheet" href="/css/highlight/style1.css"><link rel="stylesheet" href="/css/reset.css"><link rel="stylesheet" href="/css/markdown.css"><link rel="stylesheet" href="/css/fonts.css"><link rel="stylesheet" href="/css/waline.css"><link rel="stylesheet" href="/css/ui.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/returnToTop.css"><link rel="stylesheet" href="/css/unicons.css"><link rel="stylesheet" href="/css/toc.css"><link rel="stylesheet" href="/css/returnToLastPage.css"><link rel="stylesheet" href="/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="https://chinese-fonts-cdn.deno.dev/packages/lxgwwenkai/dist/LXGWWenKai-Regular/result.css"><meta name="generator" content="Hexo 7.3.0"></head><style>.index-main{max-width:1200px}</style><style>.archive-main a:hover{text-decoration:none}</style><style>:root{--waline-theme-color:#323e74;--waline-color:#323e74;--waline-border-color:#323e74;--waline-white:#323e74;--waline-bgcolor-light:#f2fafc}body{color:#323e74;background:#eaeae8}.post-md code{background:#e7f7f3;color:#7f688d}.post-md .highlight,.post-md pre{background:#e7f7f3;color:#7f688d}pre .header,pre .inheritance,pre .ruby .symbol,pre .string,pre .value,pre .xml .cdata{color:#323e74}pre .built_in,pre .constant,pre .literal,pre .number,pre .params,pre .preprocessor{color:#323e74}.year-font-color{color:#323e74!important}.wl-card span.wl-nick{color:#323e74}.wl-card .wl-badge{border:1px solid #323e74;color:#323e74}.wl-btn{border:1px solid #323e74;color:#323e74}.wl-btn.primary{color:#f2fafc}.wl-header label{color:#323e74}a{color:#7f688d}.post-md a{color:#7f688d}.nav li a{color:#7f688d}.archive-main a:link{color:#7f688d}.archive-main a:visited{color:#767c7c}.archive li span{color:#323e74}.post-main-title{color:#323e74}.post-md h1,.post-md h2,.post-md h3,.post-md h4,.post-md h5,.post-md h6{color:#323e74}[data-waline] p{color:#323e74}[data-waline] a{color:#323e74}.wl-sort li.active{color:#323e74}.wl-card .wl-meta>span{background:#f2fafc}.paper{background:#eaeae8}.index-main{background:#f2fafc}.paper-main{background:#f2fafc}.wl-panel{background:#f2fafc}.archive li:nth-child(odd){background:#f2fafc}.archive li:nth-child(even){background:#f2fafc}.post-md table tr:nth-child(odd) td{background:#f2fafc}.post-md table tr:nth-child(even) td{background:#f2fafc}.progress-wrap::after{color:#323e74}.progress-wrap svg.progress-circle path{stroke:#323e74}.progress-wrap::before{background-image:linear-gradient(298deg,#7f688d,#7f688d)}.return-to-last-progress-wrap::after{color:#323e74}.return-to-last-progress-wrap svg.progress-circle path{stroke:#323e74}.return-to-last-progress-wrap::before{background-image:linear-gradient(298deg,#7f688d,#7f688d)}.left-toc-container::-webkit-scrollbar-thumb{background-color:#323e74}.bs-docs-sidebar .nav>.active>a,.bs-docs-sidebar .nav>li>a:focus,.bs-docs-sidebar .nav>li>a:hover{color:#7f688d;border-left-color:#7f688d}.bs-docs-sidebar .nav>li>a{color:#323e74}</style><style>body{background-image:url(/img/ainwpu.jpg);background-attachment:fixed;background-repeat:no-repeat;background-size:cover;background-position:center}.paper{background-image:url(/img/ainwpu.jpg);background-attachment:fixed;background-repeat:no-repeat;background-size:cover;background-position:center}</style><body><script src="/js/darkmode-js.min.js"></script><script>const options={bottom:"40px",right:"unset",left:"42px",time:"0.3s",mixColor:"#fff",backgroundColor:" #eaeae8  ",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"🌓",autoMatchOsTheme:!0},darkmode=new Darkmode(options);darkmode.showWidget()</script><div class="left-toc-container"><nav id="toc" class="bs-docs-sidebar"></nav></div><div class="paper"><div class="shadow-drop-2-bottom paper-main"><div class="header"><div class="header-container"><style>.header-img{width:56px;height:auto;object-fit:cover;transition:transform .3s ease-in-out;border-radius:50%}.header-img:hover{animation:rotateAnimation 2s linear infinite}@keyframes rotateAnimation{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style><img alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.png"><div class="header-content"><a class="logo" href="/">合安涵</a> <span class="description">一名网络空间安全专业的小白成长之路</span></div></div><ul class="nav"><li><a href="/">首页</a></li><li><a href="/projects/">项目&amp;成果</a></li><li><a href="/blog/">技术博客</a></li><li><a href="/resources/">资源工具</a></li><li><a href="/about/">关于我</a></li></ul></div><div class="post-main"><div class="post-main-title" style="text-align:center">看懂&#34;授时中心被黑&#34;的整件事：一条从手机到电脑的隐蔽渗透链</div><div class="post-head-meta-center"><span>最近更新：2025-10-23</span> &nbsp; | &nbsp; <span>字数总计：7.9k</span> &nbsp; | &nbsp; <span>阅读估时：26分钟</span> &nbsp; | &nbsp; <span id="busuanzi_container_page_pv">阅读量：<span id="busuanzi_value_page_pv"></span>次</span></div><div class="post-md"><div class=".article-gallery"><blockquote><p>说明：文中“本报告/技术报告”均指《关于国家授时中心遭受美国国家安全局网络攻击事件的技术分析报告》；“三角测量行动（Operation Triangulation）”的细节引自公开技术史料。</p></blockquote><h1>零、这件事为什么重要</h1><p>授时中心提供国家标准时间, 相当于全国的“总时钟”。从电力系统的相角同步到金融交易的时间戳, 从通信基站的切换到卫星地面站的测控, 都要依靠这一套统一而精确的时间基准。如果“时钟”被窃取信息, 被干扰, 甚至被篡改, 下游很多行业会出现连锁反应, 轻则业务异常, 重则引发安全与合规风险。</p><p>十月十九日, 国家安全机关通报授时中心遭受境外机构长期网络攻击, 并公布了完整的技术分析。时间点与披露主体都说明, 这是经过调查取证后的正式结论, 而不是零散传闻。这起事件的危险之处不止在“被攻击”, 更在攻击路径的现实性。对方先盯上少数工作人员的手机, 借助手机侧的漏洞与隐蔽手法获取账号口令与敏感信息, 再把战线推进到单位电脑与内部业务系统。手机已经成为进入关键单位网络的入口, 这意味着传统“只管电脑”的安全边界正在失效。</p><p>攻击目标的指向也值得警惕。披露明确写到, 渗透面覆盖多个内部业务系统, 还企图触及高精度地基授时导航等重要基础设施。授时导航系统是很多关键工程的时间坐标, 一旦遭到干扰或被用作进一步渗透的跳板, 风险会向更大范围扩散。从对手画像看, 这是一次长期、专业、隐蔽的攻击行动。报告说明, 行动自二〇二二年三月起持续推进, 攻击者在战术、免杀、加密通信等方面具备很强的对抗能力, 会利用正常证书和系统模块伪装自己, 并使用多层加密把通信藏在“暗道”里。这样的特征决定了它不是一次性骚扰, 而是面向要害目标的耐心渗透。</p><p>为什么和每个人都有关系。时间服务看起来离日常很远, 实际上很多日常操作都压着时间线在跑。手机通话与基站切换需要同步, 网约车与地图定位要校时, 银行转账与清算要对账外加时间戳, 证券交易与风控依赖毫秒级时间一致。如果提供时间的上游被盯上, 即使并未造成直接破坏, 风险也会沿着“凭证泄露、横向渗透、数据窃取”的路径向下游蔓延, 影响可靠性与信任度。此次披露把起点、路径与企图都说清楚了, 这是判断风险等级的重要依据。</p><h1>一、攻击从哪里开始</h1><p>起点在手机。对方先给目标手机发一条看不见的 iMessage，用户不会收到提示，也不需要点任何东西。手机后台会处理这条隐藏附件，随后在后台拉起网页脚本，判断设备是否“值得继续”。如果条件满足，就继续下载和利用后续组件，层层把权限提上去，直到可以在系统里做更多事情。公开研究把这条入侵链称作“三角测量行动”。它的入口是不可见的 iMessage 附件，这个附件曾被伪装成表盘文件 .watchface，本质是一个组合压缩包。手机接到后，系统在后台打开 Safari，再去加载下一阶段的利用代码。整条链包含很多步，串起多枚 iOS 漏洞，目标是拿到更高权限。研究者把这起攻击评为少见的复杂，提到感染链共有十四个阶段，并至少动用了四个零日漏洞。影响范围不仅限于 iOS 15 系列，相关技巧在 16.2 之前仍被证实有效。</p><p>为绕过新款 iPhone 的内存保护，攻击链里还利用了 A12 到 A16 处理器上的未公开硬件机制。研究披露，利用代码通过写入未文档化的 MMIO 寄存器影响到内核受保护的内存区域，这一环节对应 CVE-2023-38606 的缓解路径。最终落地的是一个只在内存里工作的间谍组件，代号 TriangleDB。它不在磁盘上留下文件，重启后会消失，但攻击者可以再次发送隐藏消息把它重新放进来。这种“内存驻留、可重复投递”的特性，让取证变得更难。</p><p>这条手机侧的入侵并不是“单兵作战”，它为后续进入单位电脑和内网创造了条件。技术报告指出，二零二二年开始，攻击者长期监控十余部手机，窃取联系人和短信等数据。二零二三年，在“三角测量行动”公开之前，对方多次使用从手机里偷到的登录凭证进入授时中心的电脑，侦察内部网络情况。把以上关键信息放在一起，就能看清第一步的逻辑。手机收到隐藏消息后在后台被打穿，间谍组件只驻留在内存里，凭证等敏感信息从手机侧被取走，然后这些凭证被用来登录单位电脑，后面的内网渗透才得以展开。</p><h1>二、为什么说这次手机入侵与授时中心事件相关</h1><p>关联不是推测, 而是有清楚的时间线与证据链。</p><p>第一步, 攻击从手机侧拿到关键信息与账号口令。<br>二〇二二年三月开始, 十余部工作人员手机被入侵, 手机里的通讯录、短信、相册、位置等被持续窃取。记录显示, 这些手机属于“某国外品牌”, 攻击行为发生在较长时间窗口内, 说明对方并非一次性采集, 而是建立长期监控。</p><p>第二步, 手机里取到的电脑登录凭证被直接用于入侵。<br>报告给出了关键节点: 二〇二二年九月, 攻击者通过网管人员的手机拿到了办公计算机的登录凭证, 随后获取了该计算机的远程控制权限。这一步把“手机被攻破”和“电脑被控制”明确接在了一起。</p><p>第三步, 这些凭证被反复使用, 在单位内部建立“前哨”。<br>二〇二三年四月十一日至八月三日, 攻击者通过匿名通信节点, 远程登录办公计算机超过八十次, 并以这台计算机为据点侦察内网结构与资产分布。这表明凭证不是一次性试探, 而是被系统化地用于持续渗透, 目标指向网管侧的关键主机。</p><p>第四步, 明确点名与“三角测量行动”的关系。<br>报告写明, 对方正是利用“三角测量行动”获取了授时中心计算机终端的登录凭证, 进而取得控制权限, 再部署特种网攻武器并持续升级。这里把“手机侧零点击入侵”和“单位电脑被接管”建立了直接因果。</p><p>把这些节点串起来, 关联就非常清楚。先是手机被隐蔽入侵并长时间取数, 其中包含能打开电脑大门的钥匙; 接着凭证被用来多次远程登录, 在网管电脑上落脚, 再向内网更深处探路; 这条链路不是单点事故, 而是持续、系统化的行动。</p><p>为了便于理解, 可以把证据链条归纳为三段。<br>一是“手机端长期取数”, 直接证明入口在移动设备。</p><p>二是“凭证被窃与远程控制”, 证明手机与电脑之间存在可复用的通道。</p><p>三是“八十余次远程登录与内网侦察”, 证明这些凭证确实被用于持续渗透, 而非偶发使用。</p><p>此外, 报告还记录了登录时段多发生在北京时间凌晨, 这与熟练对手规避人工值守时段的习惯吻合, 进一步说明这些登录并非误操作或单点异常, 而是有组织的入侵行为。</p><p>综上, 手机被打穿不是孤立事件。它直接提供了能打开单位电脑与内部网络的钥匙, 并且这些钥匙在随后几个月被反复使用, 最终把入侵从个人设备延伸到核心业务环境。</p><h1>三、进入单位网络后发生了什么</h1><p>进入内部网络之后，对方先把“落脚点”稳住，再把“暗道”修好，最后把“工具箱”搬进来，配合起来做长期渗透与数据提取。</p><ol><li>先把据点扎稳</li></ol><p>第一步是把早期版本的 Back_Eleven 落在网管电脑上。这个阶段的工具还不算成熟，每次动手前，都会先远程把杀毒软件关掉，做完再把内存里的程序和操作痕迹清理干净。这样做的目的很直接，减少被发现的概率，保证下一次还能继续用这台机器当“据点”。报告把时间点写得很清楚，从二〇二三年八月三日到二〇二四年三月二十四日都在反复进行这件事，并给出了关闭杀毒软件的记录。对防守方来说，这意味着单靠客户端杀毒软件很难兜底。因为对方是先“关掉门卫”再行动，干完活再“抹地板”。这也是为什么后来溯源时，更多的线索来自网络行为与时间线对比，而不是单纯靠主机残留。</p><ol start="2"><li>再把暗道修好</li></ol><p>等到环境摸清楚，对方开始“升级武器库”。二〇二四年三月至四月，攻击者针对现场环境做了定制升级，在同一台机器里加载三款核心组件，名字分别叫 eHome_0cx、Back_Eleven、New_Dsz_Implant，同时还配套二十多种功能模块和十多份配置文件。升级后的目标很明确，让工具能够长期驻留，让控制尽量隐蔽，还要具备更完整的数据窃取能力。这三件核心组件是一个分工明确的小团队。eHome_0cx 像前哨和管家，负责常驻、自启动、内部调度和加密通信。它会通过劫持系统正常服务来实现自启动，启动后还会抹掉内存中的可执行文件头数据，减少取证时能看到的痕迹。</p><p>它内部用主机的唯一标识 GUID 当成解密钥匙，模块之间通过本地通信端口协作，对外通信时先用 RSA 交换会话密钥，再通过 TLS 传输密文。这样既能保证“自己人之间说话能听懂”，又能保证“外面听不懂”。Back_Eleven 负责搭建通信隧道与执行命令，是“暗道”和“指挥通道”的结合。它由 eHome_0cx 加载运行，自带严格的运行环境检查。如果发现系统版本不符合预期或者有人在调试，就会启动自删除。它还有反调试能力，进一步增加逆向难度。</p><p>New_Dsz_Implant 则像一个可扩展的工具箱，本身通过加载不同的功能模块来完成具体任务。三者配合后，不只是“能连上外面”，而是“能在看不见的情况下稳定、长期地连上外面，还能按需装插件完成窃密”。升级完成后，三款组件互相配合，把通信加密做到了“层层套壳”。常态下内层是 RSA 加 AES，外层再走 TLS。在关键阶段，几件武器叠加使用，形成四层加密隧道。对于排查者来说，即便截获了流量，也很难在短时间内还原内容和意图。报告直接点出了“四层加密隧道”的表述。</p><ol start="3"><li>以据点为跳板向内推进</li></ol><p>暗道修好之后，下一步就是扩大控制面。二〇二四年五月到六月，对方利用 Back_Eleven，把网管电脑当跳板，尝试触达上网认证服务器和防火墙等关键设备。到了六月十三日九点，先激活 eHome_0cx，再植入 Back_Eleven 与 New_Dsz_Implant，以此为跳板窃取认证服务器数据。七月十三日九点，再次激活并下发同样的组件执行窃取。定在整点做动作，有利于统一调度，也能降低频繁操作带来的暴露。</p><ol start="4"><li>这套组合为什么难缠</li></ol><p>难缠在几个方面。第一是“能活”。eHome_0cx 通过系统服务劫持实现自启动，还会抹痕；Back_Eleven 会在不安全时自删，减少被抓包和样本捕获的机会。</p><p>第二是“能藏”。四层加密让通信像把信件装进一层又一层上锁的盒子里，即使被截获也很难解读。</p><p>第三是“能变”。二十多种功能模块和十多份配置，就像给工具箱装了很多附件，按任务需要随时更换。</p><p>把这几步连起来看，就能明白进入单位网络后的节奏。先用早期版本站住脚，每次只在关掉“门卫”的情况下操作，并在结束后清场。等到环境摸透，再一次性把“据点、暗道、工具箱”三件套装齐，建立起稳定的隐蔽通道和可扩展能力。随后选择关键节点做跳转和取数，并把关键操作集中在可控的时间点上，降低被值守人员即时发现的可能。整个过程既谨慎又耐心，符合有组织的长期渗透特征。</p><h1>四、他们用的“三件套”各做什么</h1><h2 id="1-eHome-0cx：前哨与驻留">1 eHome_0cx：前哨与驻留</h2><p>把它想成“据点”和“管家”。首先要做到开机就活着。报告显示，它由四个模块组成，通过 DLL 劫持系统正常服务来实现自启动，典型目标包括资源管理器和事件日志服务。启动后会抹掉内存中的可执行文件头，减少被取证工具直接识别的痕迹。</p><p>其次要在内部“拉线”。它把受控主机的唯一标识 GUID 当作解密资源的钥匙，模块之间走本地 LPC 端口，通过“指令号”触发对应功能，这样既利于分工协作，也便于按需调用。</p><p>最后要能“对外悄悄说话”。与主控端通信时，它内置 RSA 公钥进行密钥交换，每次产生新的会话密钥，再把真正的数据放进 TLS 会话里传出去。外界即便截到流量，也只会看到一条正常的加密通道。</p><p>一句话总结它的职责。eHome_0cx 负责“常驻、隐蔽、调度”和“加密对话”，把主机变成一个稳定的前哨。</p><h2 id="2-Back-Eleven：隧道与指挥">2 Back_Eleven：隧道与指挥</h2><p>它是“交通枢纽”和“指挥通道”的合体。工作有两种形态。主动模式下，它会先解密内置的控制服务器地址，再用 RSA 完成密钥交换，用 AES 把上线信息加密，最后放进 TLS 里送到主控端。被动模式下，它监听网卡流量，筛选主控端发来的特征数据包，接到特征包再执行命令。</p><p>为了活得更久，它在上线前会做严格的环境检查。如果发现系统版本异常或存在调试器，就会触发自删除。同时内置反调试能力，提高逆向分析成本。</p><p>Back_Eleven 由 eHome_0cx 加载运行，初始连接阶段会向主控端发送带有数字“11”的握手标识，这也是名字的来源。整体看，它把“能通、能控、能藏”这三件事做在了一起。</p><h2 id="3-New-Dsz-Implant：模块化窃密框架">3 New_Dsz_Implant：模块化窃密框架</h2><p>它更像一个空心的“工具箱”。自身并不直接窃密，而是根据主控端的指令动态加载不同插件完成具体任务。本次事件中，攻击者实际加载了二十五个功能模块，覆盖收集、控制、外传等多种用途。</p><p>设计上与 NSA 已知平台 DanderSpritz 高度同源。报告把它归在“数据窃取类武器”，说明其定位就是把数据“拿出来并送出去”。在通信路由上，它与 eHome_0cx 和 Back_Eleven 配合紧密。自身对外先走两层加密，内层用 AES，外层用 TLS；数据经本地回环交给 Back_Eleven，再叠两层，形成四层嵌套，关键阶段如模块下发与窃密传输都会这么做。</p><p>把三件套放在一起看，角色清晰。eHome_0cx 负责“驻留与调度”，Back_Eleven 负责“隧道与指挥”，New_Dsz_Implant 负责“插件化窃密”。报告统计武器、功能模块和恶意文件总计四十二个，分为前哨控守、隧道搭建、数据窃取三大类，组合出一套隐蔽而完整的渗透与取数体系。</p><h1>五、那“多层加密”到底有多隐蔽</h1><p>可以把它想成把同一封信装进四个套着的锁盒。每一层锁和钥匙都不一样。就算有人半路拦到了数据，也很难在有限时间内把内容还原出来。<br>先看基本做法。三款武器各自都带着两层加密。里面一层用 RSA 和 AES 完成密钥交换与数据加密，外面一层走 TLS 会话。这样既保证数据被加密，又让外表看起来像普通的加密流量。报告把这点写得很明确。</p><p>再看它们如何“叠起来”。当 New_Dsz_Implant 把数据往外送时，会先自己做两层加密，内层用 AES，外层用 TLS 1.2。然后它不直接把流量发到外网，而是先通过本地回环把数据交给 Back_Eleven。Back_Eleven 接手后，再加上它自己的两层加密，最后才发出网络。四层就这样凑齐了。报告配了“嵌套加密模式”和“本地回环通信”的图示。</p><p>为什么要这么麻烦。第一是“像”。外层使用 TLS，会让很多探测设备只看到一条常见的加密通道。第二是“分层”。不同组件各管一段加密流程，就算只抓到其中一段，也很难完整复原。第三是“抗取证”。回环转发把链路拆成了两段，关键密钥和过程分散在不同进程里，提高了分析门槛。报告给出的评语是隐蔽性很强。</p><p>这套加密还不是原地踏步。报告把它拿去和已知工具 NOPEN 做了对比。NOPEN 用的是 RSA 加 RC6，如今这套是 RSA 加 AES 再叠 TLS，强度和隐蔽性都比过去更进一步。</p><p>对防守方意味着什么。只看外联流量，很可能只会看到一串TLS会话，很难直接判断内容和行为。要想识别这类手法，需要把主机侧的“谁在本地回环上说话”和网络侧的“什么时候往外发起 TLS 连接”对起来看，再结合具体进程、时间点和行为轨迹做侧像分析。报告中的加密细节与回环图示，提供了对齐这些线索的依据。</p><p>合在一起看，这是一种“看着正常、层层包裹、彼此协同”的通信方式。常态两层负责日常隐蔽，关键阶段通过协作把壳再加厚到四层，既能稳定出网，又尽量减少被看穿的机会。</p><h1>六、“三角测量行动”的技术看点，和它与本案的关系</h1><p>“三角测量行动”这条链，厉害在三个层面。入口是看不见的消息，推进靠多枚漏洞和硬件细节，落地是一套只留在内存里的间谍程序。</p><h2 id="入口怎么来">入口怎么来</h2><p>攻击从一条不可见的 iMessage 开始。消息里带有特制附件，系统会在后台自行处理，用户没有任何点击动作。处理附件后，手机会在后台拉起网页，执行探测脚本，判断设备型号与系统版本是否“值得继续”，如果满足条件，就进入后续利用阶段。安全社区总结，这个附件曾被伪装成表盘文件 watchface，本质是一个打包文件，目的是触发 Safari 在后台继续加载利用代码。</p><h2 id="推进怎么做">推进怎么做</h2><p>公开技术材料把整条感染链拆成十余个阶段。研究者披露，链条至少串起四个 iOS 零日，并且在新款 iPhone 上借助未公开的硬件机制绕过内存保护。最重要的一环，是内核层的 CVE-2023-38606。利用代码通过写入未文档化的内存映射寄存器，影响到内核的受保护区域，从而突破硬件防护。此前还有字体指令相关的 CVE-2023-41990 用于更早的入口阶段，二者共同构成“零点击到高权限”的关键阶梯。</p><h2 id="落地放了什么">落地放了什么</h2><p>最终投放的是 TriangleDB。它是模块化的间谍组件，只在内存中工作，不在磁盘落地，手机重启后会消失，但攻击者可以再次投递消息把它重新放进去。因为驻留在内存里，取证会更难，需要通过备份侧的痕迹来交叉验证。</p><h2 id="能不能自查">能不能自查</h2><p>Kaspersky 发布了 triangle_check 工具。做法是把 iPhone 通过电脑生成一次本地加密备份，再用该工具离线扫描是否存在“指示性痕迹”。工具有开源版本，也提供现成可执行文件，适合安全团队批量排查。</p><h2 id="和本案的关系">和本案的关系</h2><p>这次授时中心事件，报告把两者直接连上了。报告写明，攻击方“利用三角测量行动获取授时中心计算机终端的登录凭证”，再凭这些凭证拿到控制权限，然后在内网部署特种网攻武器并持续升级。时间线同样对得上，报告记录二〇二二年开始手机侧被长期监控与取数，二〇二三年起多次使用从手机里窃取的凭证远程登录授时中心电脑，先侦察内部，再搭建长期控制。</p><h2 id="需要特别说明的边界">需要特别说明的边界</h2><p>公开的“三角测量行动”研究侧重技术还原和检测方法，强调零点击入口、十四步感染链、四个零日以及 A12 到 A16 涉及的未公开硬件特性，并未就攻击者身份给出最终归因。授时中心技术报告在本地事件中给出了明确的归因结论，这属于另一类证据体系。传播时应把“技术画像”与“归因结论”分开理解。</p><p>把以上几块拼起来，可以清楚看到因果链。手机侧的零点击让攻击者不经任何交互就能进来，硬件层绕过保证了在新设备上也能提权，内存驻留让痕迹更少，凭证被取走后进一步打开单位电脑与内网。授时中心事件正是沿着这条路径推进，从个人设备跨到关键业务环境。</p><h1>七、风险面向哪里</h1><p>报告给出的结论很明确：攻击不仅已触达授时中心的多类内部业务系统与关键信息点位，还试探并企图深入到“高精度地基授时导航系统”等重大科技基础设施。一旦时间基准被扰动，其风险会沿着“时间供应链”外溢——从授时源头、传输分发（NTP/PTP/专线/卫星/地基网）、到行业系统与终端设备——层层放大、跨域联动，这也是事件被“格外重视”的根本原因。</p><h2 id="1）直接面向的风险面">1）直接面向的风险面</h2><p><strong>授时中心内部面</strong>：网管终端、认证服务器、防火墙等被渗透与控守，形成长期据点，为进一步靠近授时链路、扩展权限与下发功能模块创造条件（报告披露的多款武器协同与四层加密通道，使渗透隐蔽性与持久性显著增强）。</p><p><strong>地基授时/导航面</strong>：对地基授时导航系统的“摸底—试探—企图攻击”意味着攻击者正尝试从 IT 域跨越到时频与测控域，把“时间”本身当作攻击面来操作。</p><h2 id="2）由“时间依赖”驱动的外溢行业">2）由“时间依赖”驱动的外溢行业</h2><ul><li><strong>电信与互联网</strong>：骨干网同步、5G/工业以太时隙调度、运营商鉴权票据/证书校验均依赖统一时钟。时间漂移会带来丢包、切换失败、认证异常与大规模服务降级。</li><li><strong>金融交易与清算</strong>：撮合撮时、对账核验、不可否认性取证依赖高精度时间戳；时钟被偏置可能触发异常风控策略、行情/订单重放窗口与合规争议。</li><li><strong>电力与能源（OT）</strong>：调度与保护依赖相量测量（事件顺序记录/故障定位），一旦时钟失准，可能出现误判/误动甚至联锁失效。</li><li><strong>交通与航运/航空</strong>：列控、导航定位和航迹监视依赖精准授时；时间错序会影响指挥调度与安全冗余。</li><li><strong>政务应急与公共安全</strong>：应急通信、监测预警与取证审计都以时间为“基准真相”，失真会削弱溯源、追责与联动处置能力。</li><li><strong>科研、测绘与高精度产业</strong>：射电天文、精密测量、芯片产线/工业控制的节拍与对齐，均受时频稳定度影响。</li></ul><h2 id="3）潜在攻击路径与效果模式">3）潜在攻击路径与效果模式</h2><ul><li><strong>偏置/漂移</strong>：让系统时间缓慢偏移，隐蔽破坏跨系统的一致性与顺序性（难以立刻被察觉）。</li><li><strong>抖动/不稳定</strong>：制造间歇性不同步，诱发失败重试、队列拥塞与性能雪崩。</li><li><strong>遮断/降级</strong>：阻断上游授时源，迫使系统退回低等级或本地自守时，长周期累积误差。</li><li><strong>伪造/重放</strong>：在传输链路构造“看似正常”的时间信号/时间戳，诱导业务层做出错误决策。</li></ul><h2 id="4）风险传播机制（为何“可扩散、可放大”）">4）风险传播机制（为何“可扩散、可放大”）</h2><ul><li><strong>树状与分层分发</strong>：NTP/PTP/专线分发具有“自上而下”的层级结构，单点失真可在下游批量复制。</li><li><strong>跨域耦合</strong>：电信 → 金融 → 互联网服务 → 工业控制链路存在强耦合，时间异常往往跨行业放大。</li><li><strong>“难感知 + 难溯源”</strong>：报告所述多层嵌套加密与模块化控守让异常更像“业务波动”，提升定位与取证难度。</li></ul><h2 id="5）为什么这起事件被格外重视">5）为什么这起事件被格外重视</h2><ul><li><strong>时间是“基础设施的基础”</strong>：它不像单一业务系统那样可局部隔离，任何源头问题都会牵一发而动全身。</li><li><strong>攻击者能力画像升级</strong>：报告显示其具备长期潜伏、动态扩展、强隐蔽通信与“向地基授时靠近”的能力边界，风险不止于数据窃密，更指向系统级操控与连锁安全。</li></ul><p><strong>小结</strong>：本次事件把“时间系统”这个往往被忽视的公共底座暴露在聚光灯下。只要授时链路被触及，风险就不再局限于单一单位或行业，而会顺着时间的分发路径跨域扩散，这正是其安全性与国家级重要性的关键所在。</p><h1>八、普通人能做什么</h1><h2 id="①-及时、到位地更新系统（含高风险加固）">① 及时、到位地更新系统（含高风险加固）</h2><ul><li><strong>iPhone/iPad 立刻更新到可用的最新稳定版</strong>（不低于修复 CVE-2023-38606 的版本，建议 ≥ iOS 16.6）。</li><li><strong>开启自动“安全响应与系统文件”</strong>：<em>设置 → 通用 → 软件更新 → 自动更新</em> 中全部打开。</li><li><strong>高风险人群</strong>（涉密/要害岗位/频繁出差海外）<strong>启用 Lockdown Mode</strong>：<em>设置 → 隐私与安全性 → 锁定模式</em>。</li><li><strong>设备过旧无法更新</strong>至受修复版本时，尽快更换可获得最新安全更新的机型。</li></ul><h2 id="②-自查是否遇到过“三角测量”并保留证据">② 自查是否遇到过“三角测量”并保留证据</h2><ul><li><strong>用 Kaspersky 的 <code>triangle_check</code> 扫描本地 iTunes/Finder 备份</strong>：<ol><li>在电脑端给 iPhone 做一次<strong>完整本地备份</strong>（若设置了加密备份，记住密码）。</li><li>安装并运行工具：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install triangle_check</span><br><span class="line">python -m triangle_check /path/to/iTunes_backup [backup_password]</span><br></pre></td></tr></table></figure><ol start="3"><li>根据输出的 <strong>SUSPICION/DETECTED</strong> 等结果判断是否命中已公开的攻击痕迹（IOC）。</li></ol></li><li><strong>出现可疑或命中时的处置</strong>：<ul><li><strong>先更新到最新系统</strong>，高风险人员<strong>开启 Lockdown Mode</strong>，必要时<strong>暂时关闭 iMessage</strong>。</li><li><strong>重启设备</strong>（可清除内存驻留载荷），并<strong>保留备份、扫描报告与相关日志</strong>，后续交由安全团队/第三方取证。</li></ul></li></ul><h2 id="③-单位层面：做成“纵深防御”，而不是单点拦截">③ 单位层面：做成“纵深防御”，而不是单点拦截</h2><blockquote><p>攻击方曾多次远程关闭主机杀软，说明<strong>单点防御易被绕过</strong>，需把“主机—网络—身份—日志—移动终端”串成闭环。</p></blockquote><ul><li><strong>主机与终端</strong><ul><li>开启 <strong>EDR/杀软防篡改</strong> 与集中策略下发，阻断本地卸载/停用；关键主机启用<strong>驱动级自保护</strong>。</li><li><strong>白名单执行</strong>（Windows AppLocker/WDAC，macOS 同类方案），仅允许运行签名、审批的二进制。</li><li><strong>最小权限</strong>与<strong>多因素认证（MFA）</strong>：撤销本地管理员；域管/运维账号按需提权、临时授权。</li><li><strong>日志留存与集中审计</strong>：主机/网关日志 ≥ 180 天，汇入 SIEM 做行为基线与异常关联。</li></ul></li><li><strong>网络与边界</strong><ul><li><strong>分段与零信任访问</strong>：管理网、办公网、生产网逻辑隔离；关键系统仅<strong>白名单通信</strong>。</li><li><strong>出站控制 + 威胁情报</strong>：基于 IOC/域名/IP/ASN 限制异常外联，提升出站可见性与阻断能力。</li></ul></li><li><strong>移动终端（iOS）管控</strong><ul><li>通过 <strong>MDM</strong> 强制<strong>最小 OS 版本</strong>（≥修复版）、<strong>自动安装安全响应</strong>、复杂口令与自动锁定。</li><li>对关键岗位<strong>强制开启 Lockdown Mode</strong>，并评估<strong>限制 iMessage</strong> 的可行性与影响面。</li></ul></li><li><strong>响应与演练</strong><ul><li>制定 <strong>“可疑 iOS 事件 SOP”</strong>：命中 IOC → <strong>隔离网络</strong> → <strong>全量备份</strong> → <strong>升级/复位</strong> → <strong>账号与令牌轮换</strong>（Apple ID、邮件、VPN、密码库等）。</li><li><strong>季度演练</strong>横向渗透与出站流量异常，验证跨段隔离与日志闭环有效性。</li></ul></li></ul><h2 id="④-1-分钟速记清单（给个人）">④ 1 分钟速记清单（给个人）</h2><ul><li><strong>立刻更新</strong>到最新系统，并开启“<strong>安全响应与系统文件</strong>”。</li><li><strong>高风险就开</strong> Lockdown Mode（随时可关）。</li><li><strong>做一次本地备份并跑 <code>triangle_check</code></strong> 自查痕迹。</li><li>命中可疑：<strong>更新 → 锁定模式 → 暂关 iMessage（如可） → 重启</strong>，同时<strong>保留证据</strong>并联系安全团队。</li></ul><blockquote><ol><li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/5mPAwWAZiNjTUuLwzdNpXg">发条消息就能破解 iPhone？苹果系统这次像被“内鬼”攻破的……</a></li><li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/9OgHlYatZJ8N-ZhB9vpAAw">解读国家级威胁“三角测量行动”（Operation Triangulation）</a></li><li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/sV0tdGiUuZkEMeOtv7wYWw">历时 4 年，iPhone 遭史上最复杂攻击！一条 iMessage 窃走所有隐私数据，Karpathy 惊呼</a></li><li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/XPjT0BVOJPJxSmASW0tXTA">关于国家授时中心遭受美国国家安全局网络攻击事件的技术分析报告</a></li></ol></blockquote></div></div><div class="post-meta"><i><span>2025-10-23</span> <span>该篇文章被 黄璇</span> <span>打上标签: <a href="/tags/%E9%9A%8F%E7%AC%94/">随笔 </a><a href="/tags/APT/">APT </a><a href="/tags/%E4%B8%89%E8%A7%92%E6%B5%8B%E9%87%8F/">三角测量 </a><a href="/tags/NSA/">NSA </a></span><span>归为分类: <a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a></span></i></div><br><div class="post-footer-pre-next"><span>上一篇：<a href="/:S9_Crypto.html">赛题解析之第九届(2024)全国高校密码数学挑战赛赛题三</a></span> <span class="post-footer-pre-next-last-span-right">下一篇：<a href="/:ctf.html">网安竞赛年年有，今年你还在吗？ ——CTF 的旋转门，转走了多少&#34;热爱安全&#34;的人</a></span></div><div class="comments-container"><div id="comment-anchor"></div><div class="comment-area-title"></div><div id="giscus"></div><script src="https://giscus.app/client.js" data-repo="inwpu/inwpu.github.io" data-repo-id="R_kgDOPMI8LA" data-category="General" data-category-id="DIC_kwDOPMI8LM4CtWwu" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="fro" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async></script></div></div><div class="footer"><span>© 1949-2025 ainwpu</span></div><div class="footer-last"><span></span></div><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "e5317d9548244f8a9c52f472cfcea521"}'></script><div id="site-runtime">本人已坚强开机运行 <span id="runtime-text"></span> <span id="heartbeat">❤️</span></div><style>#site-runtime{text-align:center;font-size:14px;margin-top:20px;color:#888}#heartbeat{display:inline-block;color:red;font-size:16px;animation:none;transform-origin:center}@keyframes beat{0%{transform:scale(1)}25%{transform:scale(1.3)}50%{transform:scale(1)}}</style><script>const startTime=new Date("2000-10-29T00:00:00");function updateRuntime(){const e=new Date-startTime,t=`${Math.floor(e/864e5)} 天 ${Math.floor(e/36e5%24)} 时 ${Math.floor(e/6e4%60)} 分 ${Math.floor(e/1e3%60)} 秒`;document.getElementById("runtime-text").innerText=t;const n=document.getElementById("heartbeat");n.style.animation="beat 0.3s ease",setTimeout(()=>{n.style.animation="none"},300)}updateRuntime(),setInterval(updateRuntime,1e3)</script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript"></script><script src="/js/toc.js"></script><script src="/js/randomHeaderContent.js"></script><script src="/js/returnToTop.js"></script><script src="/js/returnToLastPage.js"></script><script src="/js/lightgallery/lightgallery.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script><script src="/js/particles.js"></script></div><script type="text/javascript">if("undefined"!=typeof lightGallery){var options1={selector:".gallery-item",plugins:[lgThumbnail,lgFullscreen,lgAutoplay,lgZoom,lgRotate,lgPager],thumbnail:!0,zoom:!0,rotate:!0,autoplay:!0,fullScreen:!0,pager:!1,zoomFromOrigin:!0,actualSize:!0,enableZoomAfter:300};lightGallery(document.getElementsByClassName(".article-gallery")[0],options1)}</script></div><div class="progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div><div class="return-to-last-progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div><div id="site-stats-float" class="glass visible"><ul><li>📄 文章数目：5</li><li>👥 本站访客数：<span id="busuanzi_container_site_uv" style="display:inline"><span id="busuanzi_value_site_uv">加载中...</span></span></li><li>📊 总浏览量：<span id="busuanzi_container_site_pv" style="display:inline"><span id="busuanzi_value_site_pv">加载中...</span></span></li><li>🆔 访客识别码：<span id="visitor-id">加载中...</span></li><li>⏱ 页面停留：<span id="stay-time">0 秒</span></li><li>🌐 IP：<span id="ip">加载中...</span></li><li>🌍 国家：<span id="country">加载中...</span></li><li>🏙 城市：<span id="city">加载中...</span></li><li>💼 运营商：<span id="org">加载中...</span></li><li>💻 系统：<span id="os">加载中...</span></li><li>🌐 浏览器：<span id="browser">加载中...</span></li><li>📱 设备：<span id="device">加载中...</span></li><li>📐 屏幕分辨率：<span id="screen-res">加载中...</span></li><li>🌏 语言偏好：<span id="language">加载中...</span></li><li>🕐 时区：<span id="timezone">加载中...</span></li><li>🎨 色彩深度：<span id="color-depth">加载中...</span></li><li>🔗 来源页面：<span id="referrer">加载中...</span></li><li>📶 网络状态：<span id="connection">加载中...</span></li><li>⏰ 当前时间：<span id="nowtime">加载中...</span></li><li>📅 页面更新：10/28/2025, 4:37:18 PM</li></ul></div><style>#site-stats-float{position:fixed!important;bottom:20px!important;right:20px!important;padding:20px 24px;max-width:340px;max-height:80vh;overflow-y:auto;font-size:13px;border-radius:20px;backdrop-filter:blur(40px) saturate(180%);-webkit-backdrop-filter:blur(40px) saturate(180%);background:rgba(255,255,255,.72);border:.5px solid rgba(255,255,255,.8);box-shadow:0 8px 32px rgba(0,0,0,.12),0 2px 8px rgba(0,0,0,.08),inset 0 1px 1px rgba(255,255,255,.9);color:#1d1d1f;z-index:10000!important;line-height:1.7;transition:opacity .6s cubic-bezier(.4,0,.2,1),transform .6s cubic-bezier(.4,0,.2,1);will-change:opacity,transform}#site-stats-float.fade-out{opacity:0;transform:translateY(10px);pointer-events:none}#site-stats-float::-webkit-scrollbar{width:6px}#site-stats-float::-webkit-scrollbar-track{background:rgba(255,255,255,.1);border-radius:3px}#site-stats-float::-webkit-scrollbar-thumb{background:rgba(0,0,0,.2);border-radius:3px}#site-stats-float::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,.3)}#site-stats-float ul{padding:0;margin:0}#site-stats-float li{list-style:none;margin-bottom:6px;word-break:break-word}</style><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>function generateUUID(){return"xxxxxx-xxxxxx".replace(/[x]/g,()=>(36*Math.random()|0).toString(36))}function getVisitorID(){let t=localStorage.getItem("visitor_uuid");return t||(t=generateUUID(),localStorage.setItem("visitor_uuid",t)),t}document.getElementById("visitor-id").textContent=getVisitorID();let staySeconds=0;const stayEl=document.getElementById("stay-time");function formatTime(t){const e=Math.floor(t/60);return(e>0?e+" 分 ":"")+t%60+" 秒"}function getSystemInfo(){const t=navigator.userAgent;let e="未知系统",n="未知浏览器",o=/Mobile|Android|iP(hone|od|ad)/.test(t)?"移动设备":"桌面设备";/Windows NT/.test(t)?e="Windows":/Mac OS X/.test(t)?e="macOS":/Android/.test(t)?e="Android":/iPhone|iPad|iPod/.test(t)?e="iOS":/Linux/.test(t)&&(e="Linux"),/Chrome\/([\d.]+)/.test(t)?n="Chrome "+t.match(/Chrome\/([\d.]+)/)[1]:/Firefox\/([\d.]+)/.test(t)?n="Firefox "+t.match(/Firefox\/([\d.]+)/)[1]:/Safari\/([\d.]+)/.test(t)&&!/Chrome/.test(t)?n="Safari":/Edg\/([\d.]+)/.test(t)&&(n="Edge "+t.match(/Edg\/([\d.]+)/)[1]),document.getElementById("os").textContent=e,document.getElementById("browser").textContent=n,document.getElementById("device").textContent=o}function updateTime(){const t=new Date;document.getElementById("nowtime").textContent=t.toLocaleString()}setInterval(()=>{staySeconds++,stayEl.textContent=formatTime(staySeconds)},1e3),fetch("https://ipapi.co/json/").then(t=>t.json()).then(t=>{document.getElementById("ip").textContent=t.ip,document.getElementById("country").textContent=t.country_name,document.getElementById("city").textContent=t.city,document.getElementById("org").textContent=t.org}).catch(()=>{document.getElementById("ip").textContent="获取失败"}),getSystemInfo(),updateTime(),setInterval(updateTime,1e3),document.getElementById("screen-res").textContent=screen.width+" × "+screen.height,document.getElementById("language").textContent=navigator.language||navigator.userLanguage||"未知";const timezone=Intl.DateTimeFormat().resolvedOptions().timeZone;document.getElementById("timezone").textContent=timezone||"未知",document.getElementById("color-depth").textContent=screen.colorDepth+" 位";const referrer=document.referrer||"直接访问";function updateConnectionStatus(){const t=navigator.onLine?"在线":"离线";let e="未知";if(navigator.connection||navigator.mozConnection||navigator.webkitConnection){const t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;let n=t.effectiveType||t.type||"未知";e="4g"===n&&t.downlink&&t.downlink>50?"5G (高速)":"4g"===n?t.downlink&&t.downlink>20?"4G/5G":"4G":"3g"===n?"3G":"2g"===n?"2G":"slow-2g"===n?"慢速 2G":n.toUpperCase(),t.downlink&&(e+=` (${t.downlink.toFixed(1)} Mbps)`)}document.getElementById("connection").textContent=t+" - "+e}document.getElementById("referrer").textContent=""===referrer?"直接访问":referrer.length>30?referrer.substring(0,30)+"...":referrer,updateConnectionStatus(),window.addEventListener("online",updateConnectionStatus),window.addEventListener("offline",updateConnectionStatus),setTimeout(()=>{const t=document.getElementById("site-stats-float");t&&t.classList.add("fade-out")},1e4)</script></body></html><script src="/js/emojiHandler.js"></script><script>document.addEventListener("DOMContentLoaded",()=>{wrapEmojis(".paper")})</script><script src="/js/hackerTerminal.js"></script>