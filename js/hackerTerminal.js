let hackerQuotes=["符号执行通过符号化输入探索程序路径，自动发现深层漏洞和边界条件错误","侧信道攻击利用密码实现的物理泄漏（功耗、时间、电磁辐射）恢复密钥","路径爆炸是符号执行的主要挑战：程序分支指数增长导致路径数量难以穷举","电压故障注入通过瞬时降低芯片供电电压，诱导指令跳过或数据翻转","SMT 求解器将路径约束转化为可满足性问题，寻找触发特定代码路径的输入","功耗分析攻击（DPA）通过统计关联功耗曲线与中间值，恢复 AES 密钥","KLEE 是基于 LLVM 的符号执行引擎，可自动生成高覆盖率测试用例","时钟故障攻击（Glitch）通过扰动时钟信号破坏指令执行时序","路径选择启发式（如覆盖率引导）帮助符号执行优先探索更有价值的路径","差分功耗分析利用不同输入下的功耗差异，推断密码算法的密钥比特","angr 是 Python 符号执行框架，支持二进制分析和自动化漏洞挖掘","硬件木马检测需要结合侧信道指纹、逻辑测试和版图检查多种手段","约束求解优化技术包括路径合并、增量求解和约束缓存","激光故障注入通过精确聚焦激光束翻转芯片特定位置的存储单元","符号污点分析追踪不可信输入的传播路径，识别信息流漏洞","RowHammer 攻击利用 DRAM 读干扰效应翻转相邻内存行的比特","路径约束是符号执行过程中分支条件的逻辑组合，决定路径可达性","电磁辐射分析（EMA）捕获芯片运行时的电磁泄漏信号恢复密钥","concolic 执行结合具体执行和符号执行，降低路径爆炸并提高可扩展性","安全启动绕过攻击通过故障注入或时序攻击破坏签名验证逻辑","符号内存模型需要处理指针别名、数组索引和堆操作的符号化","缓存时序攻击利用缓存命中/缺失的时间差异推断密钥相关的内存访问","路径剪枝技术通过静态分析和启发式规则减少不可行路径的探索","ChipWhisperer 是开源硬件平台，用于功耗分析和故障注入实验","抽象解释通过抽象域近似程序语义，验证符号执行无法穷举的属性","边界扫描（JTAG）是硬件调试接口，可用于固件提取和调试访问","符号执行引擎需要建模系统调用、库函数和硬件交互行为","模板攻击是一种机器学习辅助的侧信道攻击，无需功耗模型假设","路径优先级调度影响符号执行的漏洞发现效率和代码覆盖率","Spectre 攻击利用 CPU 推测执行和缓存侧信道跨越隔离边界泄漏数据","混合执行策略在具体执行遇到复杂约束时切换到符号求解模式","光学故障注入通过背面激光照射硅片，实现精确的单比特翻转","符号执行的状态空间管理需要权衡内存开销和路径探索完整性","简单功耗分析（SPA）通过观察单条功耗曲线推断密码算法执行流程","KLEE 的测试用例生成能力已成功发现数百个真实软件中的漏洞","熔断攻击（Meltdown）利用乱序执行和缓存侧信道读取内核内存","符号化策略决定哪些变量符号化、如何建模外部环境和库函数","硬件安全模块（HSM）通过物理防护和侧信道对抗保护密钥存储","路径敏感分析在符号执行中维护不同路径的独立状态，提高精度","Z3 是高效的 SMT 求解器，广泛应用于符号执行和程序验证工具链"];class HackerTerminal{constructor(){this.currentQuote="",this.currentIndex=0,this.isDeleting=!1,this.typeSpeed=80,this.deleteSpeed=40,this.pauseTime=3e3,this.quoteIndex=0,this.init()}init(){this.quoteIndex=Math.floor(Math.random()*hackerQuotes.length),this.currentQuote=hackerQuotes[this.quoteIndex],this.createTerminal(),this.type()}createTerminal(){var t=document.createElement("div");t.id="hacker-terminal",t.innerHTML=`
            <div class="terminal-header">
                <span class="terminal-title">💡 硬件安全 & 符号执行知识</span>
                <div class="terminal-controls">
                    <span class="terminal-btn close" id="terminal-close-btn"></span>
                    <span class="terminal-btn minimize" id="terminal-minimize-btn"></span>
                    <span class="terminal-btn maximize" id="terminal-maximize-btn"></span>
                </div>
            </div>
            <div class="terminal-body">
                <span id="terminal-text"></span>
                <span class="terminal-cursor">▌</span>
            </div>
        `,document.body.appendChild(t),this.attachEventListeners()}attachEventListeners(){document.getElementById("terminal-close-btn").addEventListener("click",()=>{let t=document.getElementById("hacker-terminal");t.style.opacity="0",t.style.transform="translateY(-20px)",setTimeout(()=>{t.style.display="none"},300)}),document.getElementById("terminal-minimize-btn").addEventListener("click",()=>{var t=document.getElementById("hacker-terminal"),e=t.querySelector(".terminal-body");"none"===e.style.display?(e.style.display="flex",t.style.height="auto"):(e.style.display="none",t.style.height="40px")}),document.getElementById("terminal-maximize-btn").addEventListener("click",()=>{this.showFullscreenAnimation()})}showFullscreenAnimation(){let e=document.createElement("div"),i=(e.id="chip-animation-fullscreen",e.innerHTML=`
            <canvas id="matrix-canvas"></canvas>
            <canvas id="circuit-canvas"></canvas>
            <div id="security-keywords"></div>
            <button id="exit-fullscreen">ESC 退出全屏</button>
        `,document.body.appendChild(e),this.animationState={stage:1,matrixCanvas:document.getElementById("matrix-canvas"),circuitCanvas:document.getElementById("circuit-canvas"),keywords:document.getElementById("security-keywords")},this.startStage1(),document.getElementById("exit-fullscreen").addEventListener("click",()=>{this.cleanupAnimation(),e.remove()}),t=>{"Escape"===t.key&&(this.cleanupAnimation(),e.remove(),document.removeEventListener("keydown",i))});document.addEventListener("keydown",i)}startStage1(){var{matrixCanvas:t,circuitCanvas:e}=this.animationState;t.style.opacity="1",e.style.opacity="0",this.matrixInterval=this.initMatrixRain(),setTimeout(()=>{this.animationState&&this.startStage2()},3e3)}startStage2(){var{matrixCanvas:t,circuitCanvas:e}=this.animationState;t.style.opacity="0.3",e.style.opacity="1",this.initCircuitBoard(),setTimeout(()=>{this.animationState&&this.startStage3()},2e3)}startStage3(){this.animationState.keywords.style.opacity="1",this.animationState.keywords.textContent="SINGLE ELECTRON FLOW";var t=this.animationState.matrixCanvas;t.style.opacity="0",this.singleElectronMode=!0,this.electrons=[this.createElectron()],setTimeout(()=>{this.animationState&&this.startStage4()},3e3)}startStage4(){this.animationState.keywords.textContent="QUANTUM CHIP COMPUTING",this.singleElectronMode=!1;for(let t=0;t<40;t++)setTimeout(()=>{this.electrons&&this.electrons.push(this.createElectron())},100*t);setTimeout(()=>{this.animationState&&(this.keywordInterval=this.initKeywordAnimation())},3e3)}cleanupAnimation(){this.matrixInterval&&clearInterval(this.matrixInterval),this.circuitAnimationFrame&&cancelAnimationFrame(this.circuitAnimationFrame),this.keywordInterval&&clearInterval(this.keywordInterval),this.animationState=null,this.electrons=null}initCircuitBoard(){var e=document.getElementById("circuit-canvas");e.getContext("2d"),e.width=window.innerWidth,e.height=window.innerHeight,this.circuitNodes=[];for(let t=0;t<60;t++)this.circuitNodes.push({x:Math.random()*e.width,y:Math.random()*e.height,radius:4*Math.random()+3});this.connections=[],this.circuitNodes.forEach((n,t)=>{this.circuitNodes.slice(t+1).forEach((t,e)=>{var i=Math.hypot(n.x-t.x,n.y-t.y);i<180&&this.connections.push({from:n,to:t,distance:i})})}),this.electrons=[],this.drawCircuitBoard()}drawCircuitBoard(){var t=document.getElementById("circuit-canvas");if(t){let i=t.getContext("2d");i.fillStyle="rgba(0, 0, 0, 0.1)",i.fillRect(0,0,t.width,t.height),this.connections.forEach(t=>{i.beginPath(),i.moveTo(t.from.x,t.from.y),i.lineTo(t.to.x,t.to.y),i.strokeStyle=`rgba(0, 255, 136, ${.3*(1-t.distance/180)})`,i.lineWidth=1.5,i.stroke()}),this.circuitNodes.forEach(t=>{i.beginPath(),i.arc(t.x,t.y,t.radius,0,2*Math.PI),i.fillStyle="#00ff88",i.shadowBlur=10,i.shadowColor="#00ff88",i.fill(),i.shadowBlur=0,i.beginPath(),i.arc(t.x,t.y,t.radius+2,0,2*Math.PI),i.strokeStyle="rgba(0, 255, 136, 0.3)",i.lineWidth=2,i.stroke()}),this.electrons&&this.electrons.forEach((t,e)=>{this.updateElectron(t),this.drawElectron(i,t),t.life<=0&&this.electrons.splice(e,1)}),this.circuitAnimationFrame=requestAnimationFrame(()=>this.drawCircuitBoard())}}createElectron(){let e=this.circuitNodes[Math.floor(Math.random()*this.circuitNodes.length)];var t=this.connections.filter(t=>t.from===e||t.to===e),t=t[Math.floor(Math.random()*t.length)];return{x:e.x,y:e.y,currentNode:e,currentPath:t,progress:0,speed:.008+.012*Math.random(),radius:3+2*Math.random(),life:1,trail:[],color:`hsl(${160+40*Math.random()}, 100%, 50%)`}}updateElectron(e){var t,i;e.currentPath?(e.progress+=e.speed,1<=e.progress?(t=e.currentPath.from===e.currentNode?e.currentPath.to:e.currentPath.from,e.currentNode=t,e.currentPath=null,e.progress=0):(t=e.currentPath.from===e.currentNode?e.currentNode:e.currentPath.to,i=e.currentPath.from===e.currentNode?e.currentPath.to:e.currentPath.from,e.x=t.x+(i.x-t.x)*e.progress,e.y=t.y+(i.y-t.y)*e.progress),e.trail.unshift({x:e.x,y:e.y}),20<e.trail.length&&e.trail.pop(),e.life-=3e-4):0<(i=this.connections.filter(t=>t.from===e.currentNode||t.to===e.currentNode)).length&&(e.currentPath=i[Math.floor(Math.random()*i.length)],e.progress=0)}drawElectron(n,r){r.trail.forEach((t,e)=>{var i=(1-e/r.trail.length)*r.life,e=r.radius*(1-e/r.trail.length);n.beginPath(),n.arc(t.x,t.y,e,0,2*Math.PI),n.fillStyle=r.color.replace("50%)",`50%, ${i})`),n.shadowBlur=15,n.shadowColor=r.color,n.fill(),n.shadowBlur=0}),n.beginPath(),n.arc(r.x,r.y,r.radius,0,2*Math.PI),n.fillStyle=r.color,n.shadowBlur=20,n.shadowColor=r.color,n.fill(),n.shadowBlur=0}initMatrixRain(){let r=document.getElementById("matrix-canvas"),a=r.getContext("2d"),s=(r.width=window.innerWidth,r.height=window.innerHeight,"01アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲン");var t=r.width/14;let o=Array(Math.floor(t)).fill(1);return setInterval(()=>{a.fillStyle="rgba(0, 0, 0, 0.05)",a.fillRect(0,0,r.width,r.height),a.fillStyle="#0f0",a.font="14px monospace",o.forEach((t,e)=>{var i=s[Math.floor(Math.random()*s.length)],n=14*e;a.shadowBlur=10,a.shadowColor="#0f0",a.fillText(i,n,14*t),a.shadowBlur=0,14*t>r.height&&.975<Math.random()&&(o[e]=0),o[e]++})},50)}initKeywordAnimation(){let t=["SYMBOLIC EXECUTION","SIDE-CHANNEL ATTACK","HARDWARE TROJAN","FAULT INJECTION","SMT SOLVER","PATH EXPLOSION","CACHE TIMING","ROWHAMMER","SPECTRE & MELTDOWN","AES CRYPTO","KLEE ENGINE","CONSTRAINT SOLVING","VOLTAGE GLITCH","POWER ANALYSIS","CHIP SECURITY"],e=document.getElementById("security-keywords"),i=0;var n=()=>{e&&(e.style.opacity="0",setTimeout(()=>{e&&(e.textContent=t[i],e.style.opacity="1",i=(i+1)%t.length)},500))};return n(),setInterval(n,3e3)}type(){var t=document.getElementById("terminal-text");!this.isDeleting&&this.currentIndex<this.currentQuote.length?(t.textContent=this.currentQuote.substring(0,this.currentIndex+1),this.currentIndex++,setTimeout(()=>this.type(),this.typeSpeed)):this.isDeleting||this.currentIndex!==this.currentQuote.length?this.isDeleting&&0<this.currentIndex?(t.textContent=this.currentQuote.substring(0,this.currentIndex-1),this.currentIndex--,setTimeout(()=>this.type(),this.deleteSpeed)):this.isDeleting&&0===this.currentIndex&&(this.isDeleting=!1,this.quoteIndex=(this.quoteIndex+1)%hackerQuotes.length,this.currentQuote=hackerQuotes[this.quoteIndex],setTimeout(()=>this.type(),500)):setTimeout(()=>{this.isDeleting=!0,this.type()},this.pauseTime)}}document.addEventListener("DOMContentLoaded",()=>{new HackerTerminal});