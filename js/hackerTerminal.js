let hackerQuotes=["符号执行通过将程序输入符号化，沿不同分支路径收集逻辑约束，从而自动合成触发深层漏洞与边界条件错误的测试用例；其精度高，但依赖环境建模和求解器能力。","侧信道攻击利用密码实现中产生的物理泄漏（功耗、时间、电磁辐射等）反推出中间值与密钥；防御可采用掩蔽、随机化和恒时实现。","路径爆炸是符号执行的主要挑战：分支数随执行深度指数增长，导致状态空间爆发，需要路径剪枝、合并与启发式调度进行控制。","电压故障注入通过瞬时扰动供电电压造成寄存器采样或时序异常，从而可能跳过安全检查或触发异常执行；可通过电源监测和冗余校验防护。","SMT 求解器将路径约束转化为可满足性问题求解，并返回满足特定执行路径的具体输入，是符号执行生成触发样例的核心组件。","差分功耗分析（DPA）通过对多次功耗轨迹进行分组与统计差异分析，恢复密码算法中某些关键中间值，从而逐步推断密钥。","KLEE 是基于 LLVM 的符号执行工具，可自动生成高覆盖率测试用例，广泛用于发现 C/C++ 程序中的边界缺陷和内存安全漏洞。","时钟故障攻击（Clock Glitch）通过扰动时钟信号使计算发生时序偏移，可能导致跳指、比较失效或逻辑流偏转；芯片可采用时钟质量监测抵御。","路径选择启发式（如覆盖率引导或变异优先）用于在符号执行中优先探索潜在高价值路径，从而提升漏洞发现的效率。","差分功耗分析通过输入差异诱导中间值差异，并观察功耗变化以推断密钥比特，是侧信道分析中应用最成熟的统计方法之一。","angr 是 Python 生态中的符号执行框架，支持二进制级分析、状态迁移、自动化漏洞挖掘和攻击路径构造。","硬件木马检测需要结合逻辑一致性检查、侧信道特征分析和版图比对等多种方法，以提高检测覆盖率与可信度。","约束求解优化技术包括路径合并、增量求解与约束缓存，可显著减少重复求解开销，提高符号执行效率。","激光故障注入通过定点照射芯片背面或前层硅结构，诱发单比特翻转或寄存器错误，用于研究安全设计的故障鲁棒性。","符号污点分析追踪不可信输入在程序中的传播路径，用于检测潜在的信息泄露、未验证数据使用和权限漂移漏洞。","RowHammer 攻击通过高频激活 DRAM 相邻行导致电荷泄漏，从而翻转受害行比特，可引发代码篡改或权限提升。","路径约束由符号执行过程中的条件分支逻辑组合而成，决定特定执行路径是否可达，是求解触发输入的核心依据。","电磁辐射分析（EMA）通过采集加密芯片运行时的电磁场变化，并使用信号与统计方法解码内部中间值与密钥信息。","Concolic 执行结合具体执行与符号执行，在真实运行上下文中生成新路径的输入，既保持可扩展性又能探索未覆盖路径。","安全启动绕过攻击通过故障注入或时序操控破坏签名验证逻辑链路，从而使未授权固件被加载；防御依赖硬件根信任和冗余验证。","符号内存模型需要正确处理指针别名、数组索引和堆分配的符号化，以确保路径分析的精确性和可扩展性。","缓存时序攻击利用缓存命中与缺失的访问延迟差异，推断关键数据访问模式，从而泄露私钥相关信息。","路径剪枝技术通过静态分析和不可达路径检测减少无效状态数量，从而降低符号执行的搜索空间压力。","ChipWhisperer 是支持功耗分析与故障注入研究的开源硬件平台，常用于侧信道攻击与安全评估教学实验。","抽象解释通过定义抽象域对程序的语义进行上界近似，可验证符号执行难以穷举覆盖的全局性质。","边界扫描（JTAG）作为硬件调试接口允许寄存器和内存访问，若未进行安全限制可能被用于固件提取和调试攻击。","符号执行引擎需要对系统调用、库函数和硬件行为进行建模，否则路径和约束可能失真或不可解。","模板攻击利用训练阶段构建的高维统计模型，在攻击阶段对并行采样的侧信道信号进行最大似然匹配以还原密钥。","路径优先级调度策略会影响漏洞触发时间和代码覆盖率，是符号执行中关键的搜索策略设计点。","Spectre 攻击利用 CPU 推测执行机制与缓存侧信道，将原本隔离的数据通过微架构状态泄露出来。","混合执行策略在复杂路径或难求解约束处切换符号执行，可在性能和可达性之间取得平衡。","光学故障注入利用背面激光照射精确扰动存储或逻辑单元，用于研究加密模块与安全电路的故障敏感性。","符号执行的状态空间管理需要在保持路径精度和限制内存开销之间做权衡，例如采用状态压缩、丢弃策略或层次化搜索。","简单功耗分析（SPA）通过观察单条功耗波形直接推测操作流程和关键位特征，通常用于噪声较低的环境。","KLEE 已被用于大量真实项目漏洞挖掘，证明其可在无需人工输入的情况下实现高覆盖率测试生成。","Meltdown 攻击利用乱序执行在权限检查前访问敏感内核数据，并结合缓存侧信道将其泄露到用户态。","符号化策略决定哪些变量应符号化以及如何抽象环境，直接影响符号执行的可扩展性和有效性。","硬件安全模块（HSM）通过物理防护、访问控制、侧信道防御与密钥不可导出机制保护敏感密钥资源。","路径敏感分析要求符号执行为不同分支状态分别维护独立抽象，有助于避免错误合并导致的假阳性信息。","Z3 是广泛应用于符号执行和程序验证的 SMT 求解器，支持位向量、数组、整数等理论，是自动化形式验证工具链的核心组件。"];class HackerTerminal{constructor(){this.currentQuote="",this.currentIndex=0,this.isDeleting=!1,this.typeSpeed=80,this.deleteSpeed=40,this.pauseTime=3e3,this.quoteIndex=0,this.init()}init(){this.quoteIndex=Math.floor(Math.random()*hackerQuotes.length),this.currentQuote=hackerQuotes[this.quoteIndex],this.createTerminal(),this.type()}createTerminal(){var t,e=document.getElementById("hacker-terminal-container");e&&((t=document.createElement("div")).id="hacker-terminal",t.innerHTML=`
            <div class="terminal-header">
                <span class="terminal-title">💡 硬件安全 & 符号执行知识</span>
                <div class="terminal-controls">
                    <span class="terminal-btn close" id="terminal-close-btn"></span>
                    <span class="terminal-btn minimize" id="terminal-minimize-btn"></span>
                    <span class="terminal-btn maximize" id="terminal-maximize-btn"></span>
                </div>
            </div>
            <div class="terminal-body">
                <span id="terminal-text"></span>
                <span class="terminal-cursor">▌</span>
            </div>
        `,e.appendChild(t),this.attachEventListeners())}attachEventListeners(){document.getElementById("terminal-close-btn").addEventListener("click",()=>{let t=document.getElementById("hacker-terminal");t.style.opacity="0",t.style.transform="translateY(-20px)",setTimeout(()=>{t.style.display="none"},300)}),document.getElementById("terminal-minimize-btn").addEventListener("click",()=>{var t=document.getElementById("hacker-terminal"),e=t.querySelector(".terminal-body");"none"===e.style.display?(e.style.display="flex",t.style.height="auto"):(e.style.display="none",t.style.height="40px")}),document.getElementById("terminal-maximize-btn").addEventListener("click",()=>{this.showFullscreenAnimation()})}showFullscreenAnimation(){let e=document.createElement("div"),i=(e.id="chip-animation-fullscreen",e.innerHTML=`
            <canvas id="matrix-canvas"></canvas>
            <canvas id="circuit-canvas"></canvas>
            <canvas id="fullscreen-effects-canvas"></canvas>
            <div id="security-keywords">
                <span id="keyword-text"></span>
                <span id="keyword-cursor">▌</span>
            </div>
            <button id="exit-fullscreen">ESC 退出全屏</button>
        `,document.body.appendChild(e),this.animationState={stage:1,matrixCanvas:document.getElementById("matrix-canvas"),circuitCanvas:document.getElementById("circuit-canvas"),effectsCanvas:document.getElementById("fullscreen-effects-canvas"),keywords:document.getElementById("security-keywords")},this.fullscreenParticles=[],this.fullscreenStars=[],this.initFullscreenEffects(),this.startStage1(),document.getElementById("exit-fullscreen").addEventListener("click",()=>{this.cleanupAnimation(),e.remove()}),t=>{"Escape"===t.key&&(this.cleanupAnimation(),e.remove(),document.removeEventListener("keydown",i))});document.addEventListener("keydown",i)}initFullscreenEffects(){var t=this.animationState.effectsCanvas;t.width=window.innerWidth,t.height=window.innerHeight,this.fullscreenEffectsCtx=t.getContext("2d"),this.animateFullscreenEffects()}animateFullscreenEffects(){if(this.animationState&&this.animationState.effectsCanvas){let a=this.fullscreenEffectsCtx;a.clearRect(0,0,this.animationState.effectsCanvas.width,this.animationState.effectsCanvas.height),this.fullscreenParticles=this.fullscreenParticles.filter(t=>(t.x+=t.vx,t.y+=t.vy,t.vy+=.25,t.life-=.02,t.size*=.96,0<t.life&&(a.beginPath(),a.arc(t.x,t.y,t.size,0,2*Math.PI),a.fillStyle=`hsla(${t.hue}, 70%, 55%, ${t.life})`,a.shadowBlur=8,a.shadowColor=`hsl(${t.hue}, 70%, 55%)`,a.fill(),!(a.shadowBlur=0)))),this.fullscreenStars=this.fullscreenStars.filter(e=>{if(e.life-=.008,e.size=Math.sin(e.life*Math.PI)*e.maxSize,e.rotation+=.04,0<e.life){a.save(),a.translate(e.x,e.y),a.rotate(e.rotation),a.beginPath();for(let t=0;t<4;t++){var i=t*Math.PI/2,n=Math.cos(i)*e.size,i=Math.sin(i)*e.size;0===t?a.moveTo(n,i):a.lineTo(n,i)}return a.closePath(),a.fillStyle=`hsla(${e.hue}, 70%, 60%, ${e.life})`,a.shadowBlur=10,a.shadowColor=`hsl(${e.hue}, 70%, 60%)`,a.fill(),a.shadowBlur=0,a.restore(),!0}return!1}),requestAnimationFrame(()=>this.animateFullscreenEffects())}}createFullscreenExplosion(e,i){var n=[220,280];for(let t=0;t<8;t++){var a=2*Math.PI*t/8+.3*(Math.random()-.5),r=2+3*Math.random();this.fullscreenParticles.push({x:e,y:i,vx:Math.cos(a)*r,vy:Math.sin(a)*r-2,life:1,size:3+2*Math.random(),hue:n[Math.floor(Math.random()*n.length)]})}for(let t=0;t<5;t++)this.fullscreenStars.push({x:e+50*(Math.random()-.5),y:i+50*(Math.random()-.5),life:1,size:0,maxSize:4+4*Math.random(),rotation:Math.random()*Math.PI*2,hue:n[Math.floor(Math.random()*n.length)]})}startStage1(){var{matrixCanvas:t,circuitCanvas:e}=this.animationState;t.style.opacity="1",e.style.opacity="0",this.matrixInterval=this.initMatrixRain(),setTimeout(()=>{this.animationState&&this.startStage2()},3e3)}startStage2(){var{matrixCanvas:t,circuitCanvas:e}=this.animationState;t.style.opacity="0.3",e.style.opacity="1",this.initCircuitBoard(),setTimeout(()=>{this.animationState&&this.startStage3()},2e3)}startStage3(){this.animationState.keywords.style.opacity="1";var t=document.getElementById("keyword-text"),t=(t&&(t.textContent="SINGLE ELECTRON FLOW"),this.animationState).matrixCanvas;t.style.opacity="0",this.singleElectronMode=!0,this.electrons=[this.createElectron()],setTimeout(()=>{this.animationState&&this.startStage4()},3e3)}startStage4(){var t=document.getElementById("keyword-text");t&&(t.textContent=""),this.animationState.keywords.style.opacity="1",this.singleElectronMode=!1;for(let t=0;t<40;t++)setTimeout(()=>{this.electrons&&this.electrons.push(this.createElectron())},100*t);setTimeout(()=>{this.animationState&&this.initKeywordAnimation()},2e3)}cleanupAnimation(){this.matrixInterval&&clearInterval(this.matrixInterval),this.circuitAnimationFrame&&cancelAnimationFrame(this.circuitAnimationFrame),this.keywordInterval&&clearInterval(this.keywordInterval),this.animationState=null,this.electrons=null}initCircuitBoard(){var e=document.getElementById("circuit-canvas");e.getContext("2d"),e.width=window.innerWidth,e.height=window.innerHeight,this.circuitNodes=[];for(let t=0;t<60;t++)this.circuitNodes.push({x:Math.random()*e.width,y:Math.random()*e.height,radius:4*Math.random()+3});this.connections=[],this.circuitNodes.forEach((n,t)=>{this.circuitNodes.slice(t+1).forEach((t,e)=>{var i=Math.hypot(n.x-t.x,n.y-t.y);i<180&&this.connections.push({from:n,to:t,distance:i})})}),this.electrons=[],this.drawCircuitBoard()}drawCircuitBoard(){var t=document.getElementById("circuit-canvas");if(t){let i=t.getContext("2d");i.fillStyle="rgba(0, 0, 0, 0.1)",i.fillRect(0,0,t.width,t.height),this.connections.forEach(t=>{i.beginPath(),i.moveTo(t.from.x,t.from.y),i.lineTo(t.to.x,t.to.y),i.strokeStyle=`rgba(0, 255, 136, ${.3*(1-t.distance/180)})`,i.lineWidth=1.5,i.stroke()}),this.circuitNodes.forEach(t=>{i.beginPath(),i.arc(t.x,t.y,t.radius,0,2*Math.PI),i.fillStyle="#00ff88",i.shadowBlur=10,i.shadowColor="#00ff88",i.fill(),i.shadowBlur=0,i.beginPath(),i.arc(t.x,t.y,t.radius+2,0,2*Math.PI),i.strokeStyle="rgba(0, 255, 136, 0.3)",i.lineWidth=2,i.stroke()}),this.electrons&&this.electrons.forEach((t,e)=>{this.updateElectron(t),this.drawElectron(i,t),t.life<=0&&this.electrons.splice(e,1)}),this.circuitAnimationFrame=requestAnimationFrame(()=>this.drawCircuitBoard())}}createElectron(){let e=this.circuitNodes[Math.floor(Math.random()*this.circuitNodes.length)];var t=this.connections.filter(t=>t.from===e||t.to===e),t=t[Math.floor(Math.random()*t.length)];return{x:e.x,y:e.y,currentNode:e,currentPath:t,progress:0,speed:.008+.012*Math.random(),radius:3+2*Math.random(),life:1,trail:[],color:`hsl(${160+40*Math.random()}, 100%, 50%)`}}updateElectron(e){var t,i;e.currentPath?(e.progress+=e.speed,1<=e.progress?(t=e.currentPath.from===e.currentNode?e.currentPath.to:e.currentPath.from,e.currentNode=t,e.currentPath=null,e.progress=0):(t=e.currentPath.from===e.currentNode?e.currentNode:e.currentPath.to,i=e.currentPath.from===e.currentNode?e.currentPath.to:e.currentPath.from,e.x=t.x+(i.x-t.x)*e.progress,e.y=t.y+(i.y-t.y)*e.progress),e.trail.unshift({x:e.x,y:e.y}),20<e.trail.length&&e.trail.pop(),e.life-=3e-4):0<(i=this.connections.filter(t=>t.from===e.currentNode||t.to===e.currentNode)).length&&(e.currentPath=i[Math.floor(Math.random()*i.length)],e.progress=0)}drawElectron(n,a){a.trail.forEach((t,e)=>{var i=(1-e/a.trail.length)*a.life,e=a.radius*(1-e/a.trail.length);n.beginPath(),n.arc(t.x,t.y,e,0,2*Math.PI),n.fillStyle=a.color.replace("50%)",`50%, ${i})`),n.shadowBlur=15,n.shadowColor=a.color,n.fill(),n.shadowBlur=0}),n.beginPath(),n.arc(a.x,a.y,a.radius,0,2*Math.PI),n.fillStyle=a.color,n.shadowBlur=20,n.shadowColor=a.color,n.fill(),n.shadowBlur=0}initMatrixRain(){let a=document.getElementById("matrix-canvas"),r=a.getContext("2d"),s=(a.width=window.innerWidth,a.height=window.innerHeight,["SMT","Z3","angr","KLEE","DPA","CPA","SPA","AES","RSA","solve()","path","fork","exec","sym_var","constraint","power","leak","glitch","trojan","side_ch","timing","cache","spectre","meltdown","rowhammer","fault_inj","voltage","laser","EM","JTAG","secure_boot","HSM","concrete","symbolic","taint","coverage","explore","claripy","solver","bitvec","ite","if_then_else","state","simgr","deadended","active","unconstrained","DFA","CFA","SSA","LLVM","IR","cfg","cdg","dfg","0x","1","0","AND","OR","XOR","NOT","SHL","SHR"]);var t=a.width/14;let o=Array(Math.floor(t)).fill(1);return setInterval(()=>{r.fillStyle="rgba(0, 0, 0, 0.05)",r.fillRect(0,0,a.width,a.height),r.fillStyle="#0f0",r.font="14px monospace",o.forEach((t,e)=>{var i=s[Math.floor(Math.random()*s.length)],n=14*e;r.shadowBlur=10,r.shadowColor="#0f0",r.fillText(i,n,14*t),r.shadowBlur=0,14*t>a.height&&.975<Math.random()&&(o[e]=0),o[e]++})},50)}initKeywordAnimation(){let i=["SYMBOLIC EXECUTION","SIDE-CHANNEL ATTACK","HARDWARE TROJAN","FAULT INJECTION","SMT SOLVER","PATH EXPLOSION","CACHE TIMING","ROWHAMMER","SPECTRE & MELTDOWN","AES CRYPTO","KLEE ENGINE","CONSTRAINT SOLVING","VOLTAGE GLITCH","POWER ANALYSIS","CHIP SECURITY"],n=document.getElementById("keyword-text"),a=0,r=0,s="",o=!1,l=()=>{var t,e;n&&this.animationState&&(o||0!==r||(s=i[a]),!o&&r<s.length?(n.textContent=s.substring(0,r+1),t=(e=n.getBoundingClientRect()).width/(r+1),t=e.left+t*r+t/2,this.createFullscreenExplosion(t,e.top+e.height/2),r++,setTimeout(l,100)):o||r!==s.length?o&&0<r?(n.textContent=s.substring(0,r-1),e=(t=n.getBoundingClientRect()).width/r,e=t.left+e*(r-1)+e/2,this.createFullscreenExplosion(e,t.top+t.height/2),r--,setTimeout(l,60)):o&&0===r&&(o=!1,a=(a+1)%i.length,setTimeout(l,500)):setTimeout(()=>{o=!0,l()},2e3))};l()}type(){var t=document.getElementById("terminal-text");!this.isDeleting&&this.currentIndex<this.currentQuote.length?(t.textContent=this.currentQuote.substring(0,this.currentIndex+1),this.currentIndex++,setTimeout(()=>this.type(),this.typeSpeed)):this.isDeleting||this.currentIndex!==this.currentQuote.length?this.isDeleting&&0<this.currentIndex?(t.textContent=this.currentQuote.substring(0,this.currentIndex-1),this.currentIndex--,setTimeout(()=>this.type(),this.deleteSpeed)):this.isDeleting&&0===this.currentIndex&&(this.isDeleting=!1,this.quoteIndex=(this.quoteIndex+1)%hackerQuotes.length,this.currentQuote=hackerQuotes[this.quoteIndex],setTimeout(()=>this.type(),500)):setTimeout(()=>{this.isDeleting=!0,this.type()},this.pauseTime)}}document.addEventListener("DOMContentLoaded",()=>{new HackerTerminal});