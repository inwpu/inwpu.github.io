<!DOCTYPE html><html lang="zh-CN,en,default"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name="viewport"><meta name="description" content="赛题解析之第九届(2024)全国高校密码数学挑战赛赛题三"><meta name="hexo-theme-A4" content="v2.0.0"><link rel="alternate icon" type="image/webp" href="/img/favicon.png"><title>合安涵 | ❤️喜吾安璇</title><link rel="stylesheet" href="/css/highlight/style1.css"><link rel="stylesheet" href="/css/reset.css"><link rel="stylesheet" href="/css/markdown.css"><link rel="stylesheet" href="/css/fonts.css"><link rel="stylesheet" href="/css/waline.css"><link rel="stylesheet" href="/css/ui.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/returnToTop.css"><link rel="stylesheet" href="/css/unicons.css"><link rel="stylesheet" href="/css/toc.css"><link rel="stylesheet" href="/css/returnToLastPage.css"><link rel="stylesheet" href="/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="https://chinese-fonts-cdn.deno.dev/packages/lxgwwenkai/dist/LXGWWenKai-Regular/result.css"><meta name="generator" content="Hexo 7.3.0"></head><style>.index-main{max-width:1200px}</style><style>.archive-main a:hover{text-decoration:none}</style><style>:root{--waline-theme-color:#323e74;--waline-color:#323e74;--waline-border-color:#323e74;--waline-white:#323e74;--waline-bgcolor-light:#f2fafc}body{color:#323e74;background:#eaeae8}.post-md code{background:#e7f7f3;color:#7f688d}.post-md .highlight,.post-md pre{background:#e7f7f3;color:#7f688d}pre .header,pre .inheritance,pre .ruby .symbol,pre .string,pre .value,pre .xml .cdata{color:#323e74}pre .built_in,pre .constant,pre .literal,pre .number,pre .params,pre .preprocessor{color:#323e74}.year-font-color{color:#323e74!important}.wl-card span.wl-nick{color:#323e74}.wl-card .wl-badge{border:1px solid #323e74;color:#323e74}.wl-btn{border:1px solid #323e74;color:#323e74}.wl-btn.primary{color:#f2fafc}.wl-header label{color:#323e74}a{color:#7f688d}.post-md a{color:#7f688d}.nav li a{color:#7f688d}.archive-main a:link{color:#7f688d}.archive-main a:visited{color:#767c7c}.archive li span{color:#323e74}.post-main-title{color:#323e74}.post-md h1,.post-md h2,.post-md h3,.post-md h4,.post-md h5,.post-md h6{color:#323e74}[data-waline] p{color:#323e74}[data-waline] a{color:#323e74}.wl-sort li.active{color:#323e74}.wl-card .wl-meta>span{background:#f2fafc}.paper{background:#eaeae8}.index-main{background:#f2fafc}.paper-main{background:#f2fafc}.wl-panel{background:#f2fafc}.archive li:nth-child(odd){background:#f2fafc}.archive li:nth-child(even){background:#f2fafc}.post-md table tr:nth-child(odd) td{background:#f2fafc}.post-md table tr:nth-child(even) td{background:#f2fafc}.progress-wrap::after{color:#323e74}.progress-wrap svg.progress-circle path{stroke:#323e74}.progress-wrap::before{background-image:linear-gradient(298deg,#7f688d,#7f688d)}.return-to-last-progress-wrap::after{color:#323e74}.return-to-last-progress-wrap svg.progress-circle path{stroke:#323e74}.return-to-last-progress-wrap::before{background-image:linear-gradient(298deg,#7f688d,#7f688d)}.left-toc-container::-webkit-scrollbar-thumb{background-color:#323e74}.bs-docs-sidebar .nav>.active>a,.bs-docs-sidebar .nav>li>a:focus,.bs-docs-sidebar .nav>li>a:hover{color:#7f688d;border-left-color:#7f688d}.bs-docs-sidebar .nav>li>a{color:#323e74}</style><style>body{background-image:url(/img/ainwpu.jpg);background-attachment:fixed;background-repeat:no-repeat;background-size:cover;background-position:center}.paper{background-image:url(/img/ainwpu.jpg);background-attachment:fixed;background-repeat:no-repeat;background-size:cover;background-position:center}</style><body><script src="/js/darkmode-js.min.js"></script><script>const options={bottom:"40px",right:"unset",left:"42px",time:"0.3s",mixColor:"#fff",backgroundColor:" #eaeae8  ",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"🌓",autoMatchOsTheme:!0},darkmode=new Darkmode(options);darkmode.showWidget()</script><div class="left-toc-container"><nav id="toc" class="bs-docs-sidebar"></nav></div><div class="paper"><div class="shadow-drop-2-bottom paper-main"><div class="header"><div class="header-container"><style>.header-img{width:56px;height:auto;object-fit:cover;transition:transform .3s ease-in-out;border-radius:50%}.header-img:hover{animation:rotateAnimation 2s linear infinite}@keyframes rotateAnimation{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style><img alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.png"><div class="header-content"><a class="logo" href="/">合安涵</a> <span class="description">一名网络空间安全专业的小白成长之路</span></div></div><ul class="nav"><li><a href="/">首页</a></li><li><a href="/projects/">项目&amp;成果</a></li><li><a href="/blog/">技术博客</a></li><li><a href="/resources/">资源工具</a></li><li><a href="/about/">关于我</a></li></ul></div><div class="post-main"><div class="post-main-title" style="text-align:center">赛题解析之第九届(2024)全国高校密码数学挑战赛赛题三</div><div class="post-head-meta-center"><span>最近更新：2025-10-28</span> &nbsp; | &nbsp; <span>字数总计：3.5k</span> &nbsp; | &nbsp; <span>阅读估时：16分钟</span> &nbsp; | &nbsp; <span id="busuanzi_container_page_pv">阅读量：<span id="busuanzi_value_page_pv"></span>次</span></div><div class="post-md"><div class=".article-gallery"><h1>零、发过了咋又发一遍</h1><p>最近后台有不少朋友在问，第九届密码数学挑战赛那篇文章里的某些细节能不能讲清楚一点，比如实验环境是怎么搭的、数据怎么选的、降噪处理用的具体方法是什么等等。</p><p>其实最初发这篇文章的时候，我们刚做完比赛，还处在那种“终于交了稿”的状态，很多过程是照着实验记录顺手整理的，没想着写得多细。现在距离那场比赛也过去一阵了，刚好最近第十届挑战赛报名临近，看到有很多同学在准备，也确实有不少人来问，就想着把那篇文章重新整理一下。</p><p>这次没有大改，只是把原来没讲清楚的部分补了一下。比如实验时用的硬件规格、降噪是怎么做的（我们用的是基于明文类别的均值滤波），以及一些中间数据的补全，还有部分图表也统一格式重新排了版。虽然是同一个题目，但这版的内容比原来更完整、也更容易复现。</p><p>如果你已经读过之前的版本，可以直接跳到你关心的部分看看有没有更新；如果你是第一次看到，希望这篇补充过的内容能对你有点帮助。不管你是准备比赛，还是单纯对侧信道分析感兴趣，都欢迎来交流。</p><h1>一、密码数学挑战赛题目分析</h1><p><a href="/images/S9_Crypto1.png" class="gallery-item" style="box-shadow:none"><img src="/images/S9_Crypto1.png" alt=""></a></p><h1>二、赛题描述</h1><p>给定采集得到关于 AES 密码芯片运行过程中的泄露样本与对应的明文信息，该泄露样本对应于 AES密码芯片执行第一轮第一个 S盒输出值。该 AES密码芯片信息泄露无法使用汉明重量模型准确刻画其信息泄露特征。问题：基于给定泄露样本与对应明文信息编写能能量分析攻击代码恢复 AES 密码芯片所使用密钥第一字节值。提示：该问题主要考察参赛人员利用统计工具准确挖掘给定数据的信息特征的能力，参赛人员可以借助概率密度函数、相关系数、互信息、KS 检测等统计工具或深度学习领域 CNN自动识别工具实现特征提取与密钥恢复的目标。</p><h1>三、赛题分析</h1><p><a href="/images/S9_Crypto2.png" class="gallery-item" style="box-shadow:none"><img src="/images/S9_Crypto2.png" alt=""></a></p><p>题目给了六组三对数据，分别对应低中高噪的plain和leakage。其中:</p><p>Plain：在AES加密过程中，&quot;plain&quot;通常指的是明文数据，即在加密之前原始的、未经加密的数据。在侧信道攻击中，攻击者的目标是尝试从加密过程中的物理或电磁泄漏中恢复出明文信息。</p><p>Leakage：在侧信道攻击中，&quot;leakage&quot;指的是加密设备在执行加密操作时无意中泄露的信息。这种泄露可能包括功耗、电磁辐射、计算时间等，它们可以被攻击者用来推断加密密钥或明文数据。“Leakage&quot;可以进一步细分为不同的级别，如&quot;high”、“medium&quot;和&quot;low”。</p><p>因本人知识背景局限性，只针对AES侧信道攻击恢复明文的方法做CPA攻击、DPA攻击、互信息代码演示，以求恢复明文信息。</p><h2 id="3-1-赛题数据">3.1.赛题数据</h2><p>赛题数据可通过全国高校密码数学挑战赛官方网站获取。</p><h2 id="3-2-赛题代码及结果">3.2.赛题代码及结果</h2><h3 id="3-2-1-CPA攻击">3.2.1.CPA攻击</h3><p>CPA攻击，全称为Correlation Power Analysis（相关功耗分析），是一种侧信道攻击技术，主要用于分析加密设备在执行加密算法时的功耗模式。通过测量设备在处理不同数据时的功耗变化，攻击者可以推断出加密密钥或其他敏感信息。</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">from scipy<span class="number">.</span>io import loadmat</span><br><span class="line">from scipy<span class="number">.</span>stats import pearsonr</span><br><span class="line">import matplotlib<span class="number">.</span>pyplot as plt</span><br><span class="line"># 加载低噪声数据</span><br><span class="line">plain_low = loadmat(<span class="string">&#x27;plain_low.mat&#x27;</span>)[<span class="string">&#x27;plain&#x27;</span>]</span><br><span class="line">leakage_low = loadmat(<span class="string">&#x27;leakage_low.mat&#x27;</span>)[<span class="string">&#x27;leakage&#x27;</span>]</span><br><span class="line"># 确保数据在<span class="number">0</span>到<span class="number">255</span>范围内</span><br><span class="line">plain_low = plain_low % <span class="number">256</span></span><br><span class="line"># AES S盒</span><br><span class="line">sbox = [</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>, <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>,</span><br><span class="line">    <span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>, <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>, <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>,</span><br><span class="line">    <span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>, <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>,</span><br><span class="line">    <span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>,</span><br><span class="line">    <span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>, <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>, <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>,</span><br><span class="line">    <span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>,</span><br><span class="line">    <span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span></span><br><span class="line">]</span><br><span class="line"># 汉明重量函数</span><br><span class="line">def hamming_weight(n):</span><br><span class="line">    return bin(n).count(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"># 构建假设功耗函数</span><br><span class="line">def hypothetical_leakage(plain, key_guess):</span><br><span class="line">    num_traces = plain<span class="number">.</span>shape[<span class="number">0</span>]</span><br><span class="line">    hypothetical = np<span class="number">.</span>zeros(num_traces)</span><br><span class="line">    </span><br><span class="line">    for i <span class="keyword">in</span> range(num_traces):</span><br><span class="line">        index = (plain[i, <span class="number">0</span>] ^ key_guess) % <span class="number">256</span>  # 确保索引在<span class="number">0</span>-<span class="number">255</span>范围内</span><br><span class="line">        intermediate_value = sbox[index]</span><br><span class="line">        hypothetical[i] = hamming_weight(intermediate_value)</span><br><span class="line">    </span><br><span class="line">    return hypothetical</span><br><span class="line"># 计算相关性函数</span><br><span class="line">def calculate_correlation(leakage, hypothetical):</span><br><span class="line">    num_samples = leakage<span class="number">.</span>shape[<span class="number">1</span>]  # 获取每条功耗曲线的采样点数量</span><br><span class="line">    correlation = np<span class="number">.</span>zeros(num_samples)  # 初始化相关系数数组</span><br><span class="line">    </span><br><span class="line">    for i <span class="keyword">in</span> range(num_samples):</span><br><span class="line">        # 计算每个采样点的相关系数</span><br><span class="line">        correlation[i] = pearsonr(leakage[:, i], hypothetical)[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    return correlation</span><br><span class="line"># 绘制相关系数曲线函数</span><br><span class="line">def plot_correlation(keys, correlations, title):</span><br><span class="line">    plt<span class="number">.</span>figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">    plt<span class="number">.</span>plot(keys, correlations)</span><br><span class="line">    plt<span class="number">.</span>title(title)</span><br><span class="line">    plt<span class="number">.</span>xlabel(<span class="string">&#x27;Key Guess&#x27;</span>)</span><br><span class="line">    plt<span class="number">.</span>ylabel(<span class="string">&#x27;Max Correlation&#x27;</span>)</span><br><span class="line">    plt<span class="number">.</span>grid(True)</span><br><span class="line">    plt<span class="number">.</span>show()</span><br><span class="line"># 恢复密钥字节函数</span><br><span class="line">def cpa_attack(plain, leakage):</span><br><span class="line">    num_guesses = <span class="number">256</span></span><br><span class="line">    max_correlation = np<span class="number">.</span>zeros(num_guesses)</span><br><span class="line">    </span><br><span class="line">    for key_guess <span class="keyword">in</span> range(num_guesses):</span><br><span class="line">        hypothetical = hypothetical_leakage(plain, key_guess)</span><br><span class="line">        correlation = calculate_correlation(leakage, hypothetical)</span><br><span class="line">        max_correlation[key_guess] = np<span class="number">.</span>max(np<span class="number">.</span><span class="built_in">abs</span>(correlation))</span><br><span class="line">    </span><br><span class="line">    best_guess = np<span class="number">.</span>argmax(max_correlation)</span><br><span class="line">    keys = np<span class="number">.</span>arange(num_guesses)</span><br><span class="line">    plot_correlation(keys, max_correlation, <span class="string">&#x27;Correlation vs Key Guess&#x27;</span>)</span><br><span class="line">    return best_guess</span><br><span class="line"># 执行CPA攻击（低噪声）</span><br><span class="line">recovered_key_low = cpa_attack(plain_low, leakage_low)</span><br><span class="line">print(f<span class="string">&#x27;恢复的密钥字节（低噪声）：&#123;recovered_key_low&#125;&#x27;</span>)</span><br><span class="line"># 加载中噪声数据</span><br><span class="line">plain_medium = loadmat(<span class="string">&#x27;plain_medium.mat&#x27;</span>)[<span class="string">&#x27;plain&#x27;</span>]</span><br><span class="line">leakage_medium = loadmat(<span class="string">&#x27;leakage_medium.mat&#x27;</span>)[<span class="string">&#x27;leakage&#x27;</span>]</span><br><span class="line"># 确保数据在<span class="number">0</span>到<span class="number">255</span>范围内</span><br><span class="line">plain_medium = plain_medium % <span class="number">256</span></span><br><span class="line"># 执行CPA攻击（中噪声）</span><br><span class="line">recovered_key_medium = cpa_attack(plain_medium, leakage_medium)</span><br><span class="line">print(f<span class="string">&#x27;恢复的密钥字节（中噪声）：&#123;recovered_key_medium&#125;&#x27;</span>)</span><br><span class="line"># 加载高噪声数据</span><br><span class="line">plain_high = loadmat(<span class="string">&#x27;plain_high.mat&#x27;</span>)[<span class="string">&#x27;plain&#x27;</span>]</span><br><span class="line">leakage_high = loadmat(<span class="string">&#x27;leakage_high.mat&#x27;</span>)[<span class="string">&#x27;leakage&#x27;</span>]</span><br><span class="line"># 确保数据在<span class="number">0</span>到<span class="number">255</span>范围内</span><br><span class="line">plain_high = plain_high % <span class="number">256</span></span><br><span class="line"># 执行CPA攻击（高噪声）</span><br><span class="line">recovered_key_high = cpa_attack(plain_high, leakage_high)</span><br><span class="line">print(f<span class="string">&#x27;恢复的密钥字节（高噪声）：&#123;recovered_key_high&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><p><a href="/images/S9_Crypto3.png" class="gallery-item" style="box-shadow:none"><img src="/images/S9_Crypto3.png" alt=""></a></p><p><a href="/images/S9_Crypto4.png" class="gallery-item" style="box-shadow:none"><img src="/images/S9_Crypto4.png" alt=""></a></p><p><a href="/images/S9_Crypto5.png" class="gallery-item" style="box-shadow:none"><img src="/images/S9_Crypto5.png" alt=""></a></p><h3 id="3-2-2-互信息">3.2.2.互信息</h3><p><strong>使用互信息进行能量分析攻击</strong></p><p>互信息（Mutual Information）是一种衡量两个随机变量之间相互依赖程度的统计量。在侧信道分析中，我们可以使用互信息来衡量假设密钥和泄漏样本之间的关系，从而恢复密钥。</p><p>密钥恢复：在具体实施过程中，攻击者基于初始密钥的每一个可能值，使用选择函数计算相应的中间值，并将泄漏信息和中间值进行离散化处理。然后计算不同密钥猜测下泄漏信息和中间值之间的互信息。互信息值最大的密钥猜测即为攻击者推断的真实密钥。</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">from scipy<span class="number">.</span>io import loadmat</span><br><span class="line">from sklearn<span class="number">.</span>metrics import mutual_info_score</span><br><span class="line">from sklearn<span class="number">.</span>preprocessing import KBinsDiscretizer</span><br><span class="line">import matplotlib<span class="number">.</span>pyplot as plt</span><br><span class="line"></span><br><span class="line"># 加载数据</span><br><span class="line">plain_low = loadmat(<span class="string">&#x27;plain_low.mat&#x27;</span>)[<span class="string">&#x27;plain&#x27;</span>]</span><br><span class="line">leakage_low = loadmat(<span class="string">&#x27;leakage_low.mat&#x27;</span>)[<span class="string">&#x27;leakage&#x27;</span>]</span><br><span class="line">plain_medium = loadmat(<span class="string">&#x27;plain_medium.mat&#x27;</span>)[<span class="string">&#x27;plain&#x27;</span>]</span><br><span class="line">leakage_medium = loadmat(<span class="string">&#x27;leakage_medium.mat&#x27;</span>)[<span class="string">&#x27;leakage&#x27;</span>]</span><br><span class="line">plain_high = loadmat(<span class="string">&#x27;plain_high.mat&#x27;</span>)[<span class="string">&#x27;plain&#x27;</span>]</span><br><span class="line">leakage_high = loadmat(<span class="string">&#x27;leakage_high.mat&#x27;</span>)[<span class="string">&#x27;leakage&#x27;</span>]</span><br><span class="line"></span><br><span class="line"># 确保数据在<span class="number">0</span>到<span class="number">255</span>范围内</span><br><span class="line">plain_low = plain_low % <span class="number">256</span></span><br><span class="line">plain_medium = plain_medium % <span class="number">256</span></span><br><span class="line">plain_high = plain_high % <span class="number">256</span></span><br><span class="line"></span><br><span class="line"># 确保数据形状正确</span><br><span class="line">if plain_low<span class="number">.</span>ndim == <span class="number">1</span>:</span><br><span class="line">    plain_low = plain_low<span class="number">.</span>reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">if plain_medium<span class="number">.</span>ndim == <span class="number">1</span>:</span><br><span class="line">    plain_medium = plain_medium<span class="number">.</span>reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">if plain_high<span class="number">.</span>ndim == <span class="number">1</span>:</span><br><span class="line">    plain_high = plain_high<span class="number">.</span>reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"># AES S盒</span><br><span class="line">sbox = [</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>, <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span>,</span><br><span class="line">    <span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>, <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>, <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span>,</span><br><span class="line">    <span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>, <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span>,</span><br><span class="line">    <span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span>,</span><br><span class="line">    <span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>, <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>, <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span>,</span><br><span class="line">    <span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span>,</span><br><span class="line">    <span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 汉明重量函数</span><br><span class="line">def hamming_weight(n):</span><br><span class="line">    return bin(n).count(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"></span><br><span class="line"># 构建假设功耗函数</span><br><span class="line">def hypothetical_leakage(plain, key_guess):</span><br><span class="line">    num_traces = plain<span class="number">.</span>shape[<span class="number">0</span>]</span><br><span class="line">    hypothetical = np<span class="number">.</span>zeros(num_traces)</span><br><span class="line">    </span><br><span class="line">    for i <span class="keyword">in</span> range(num_traces):</span><br><span class="line">        intermediate_value = sbox[plain[i, <span class="number">0</span>] ^ key_guess]</span><br><span class="line">        hypothetical[i] = hamming_weight(intermediate_value)</span><br><span class="line">    </span><br><span class="line">    return hypothetical</span><br><span class="line"></span><br><span class="line"># 计算互信息</span><br><span class="line">def calculate_mutual_information(leakage, hypothetical):</span><br><span class="line">    num_samples = leakage<span class="number">.</span>shape[<span class="number">1</span>]  # 获取每条功耗曲线的采样点数量</span><br><span class="line">    mutual_information = np<span class="number">.</span>zeros(num_samples)  # 初始化互信息数组</span><br><span class="line">    </span><br><span class="line">    # 使用KBinsDiscretizer对泄露样本进行离散化处理</span><br><span class="line">    discretizer = KBinsDiscretizer(n_bins=<span class="number">10</span>, encode=<span class="string">&#x27;ordinal&#x27;</span>, strategy=<span class="string">&#x27;uniform&#x27;</span>, subsample=None)</span><br><span class="line">    leakage_discrete = discretizer<span class="number">.</span>fit_transform(leakage)</span><br><span class="line">    </span><br><span class="line">    for i <span class="keyword">in</span> range(num_samples):</span><br><span class="line">        # 计算每个采样点的互信息</span><br><span class="line">        mutual_information[i] = mutual_info_score(leakage_discrete[:, i], hypothetical)</span><br><span class="line">    </span><br><span class="line">    return mutual_information</span><br><span class="line"></span><br><span class="line"># 绘制互信息曲线函数</span><br><span class="line">def plot_mutual_information(keys, mutual_informations, title):</span><br><span class="line">    plt<span class="number">.</span>figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">    plt<span class="number">.</span>plot(keys, mutual_informations)</span><br><span class="line">    plt<span class="number">.</span>title(title)</span><br><span class="line">    plt<span class="number">.</span>xlabel(<span class="string">&#x27;Key Guess&#x27;</span>)</span><br><span class="line">    plt<span class="number">.</span>ylabel(<span class="string">&#x27;Max Mutual Information&#x27;</span>)</span><br><span class="line">    plt<span class="number">.</span>grid(True)</span><br><span class="line">    plt<span class="number">.</span>show()</span><br><span class="line"></span><br><span class="line"># 恢复密钥字节函数</span><br><span class="line">def mia_attack(plain, leakage):</span><br><span class="line">    num_guesses = <span class="number">256</span></span><br><span class="line">    max_mutual_information = np<span class="number">.</span>zeros(num_guesses)</span><br><span class="line">    </span><br><span class="line">    for key_guess <span class="keyword">in</span> range(num_guesses):</span><br><span class="line">        hypothetical = hypothetical_leakage(plain, key_guess)</span><br><span class="line">        mutual_information = calculate_mutual_information(leakage, hypothetical)</span><br><span class="line">        max_mutual_information[key_guess] = np<span class="number">.</span>max(mutual_information)</span><br><span class="line">    </span><br><span class="line">    best_guess = np<span class="number">.</span>argmax(max_mutual_information)</span><br><span class="line">    keys = np<span class="number">.</span>arange(num_guesses)</span><br><span class="line">    plot_mutual_information(keys, max_mutual_information, <span class="string">&#x27;Mutual Information vs Key Guess&#x27;</span>)</span><br><span class="line">    return best_guess</span><br><span class="line"></span><br><span class="line"># 执行MIA攻击（低噪声）</span><br><span class="line">recovered_key_low = mia_attack(plain_low, leakage_low)</span><br><span class="line">print(f<span class="string">&#x27;恢复的密钥字节（低噪声）：&#123;recovered_key_low&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"># 执行MIA攻击（中噪声）</span><br><span class="line">recovered_key_medium = mia_attack(plain_medium, leakage_medium)</span><br><span class="line">print(f<span class="string">&#x27;恢复的密钥字节（中噪声）：&#123;recovered_key_medium&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"># 执行MIA攻击（高噪声）</span><br><span class="line">recovered_key_high = mia_attack(plain_high, leakage_high)</span><br><span class="line">print(f<span class="string">&#x27;恢复的密钥字节（高噪声）：&#123;recovered_key_high&#125;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="/images/S9_Crypto6.png" class="gallery-item" style="box-shadow:none"><img src="/images/S9_Crypto6.png" alt=""></a></p><p><a href="/images/S9_Crypto7.png" class="gallery-item" style="box-shadow:none"><img src="/images/S9_Crypto7.png" alt=""></a></p><p><a href="/images/S9_Crypto8.png" class="gallery-item" style="box-shadow:none"><img src="/images/S9_Crypto8.png" alt=""></a></p><h1>4.实验结果分析</h1><p>实验运行环境如下：<br>Windows 10<br>Pycharm 2024.1<br>Intel Core i7-9700<br>RAM:16G<br>ROM:512G<br>初步实验时，我们首先对CPA、DPA、MIA和PDF分三种方式都进行了尝试，经过证明4种方式在不考虑选取条数的情况下都可以成功攻击出密钥，对于每种方法，我们选取不同的条数分别进行若干次，下面是我们分别从能量迹使用数量、破解密钥速度分析实验结果。首先是对于低噪声破解不同的方法选取不同的条数进行1000时的成功率（表格中第一个数据为成功率，第二个数据为平均一次攻击的时间）：</p><p align="center"><b>表1 低噪下不同的方法选取不同的条数实验结果</b></p><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">CPA</th><th style="text-align:center">DPA（随机选取 m*n 条）</th><th style="text-align:center">MIA</th><th style="text-align:center">PDF</th></tr></thead><tbody><tr><td style="text-align:center">m=90</td><td style="text-align:center">85.90%</td><td style="text-align:center">57.30%</td><td style="text-align:center">2.30%</td><td style="text-align:center">0.80%</td></tr><tr><td style="text-align:center">n=3</td><td style="text-align:center">0.1860 秒</td><td style="text-align:center">0.0307 秒</td><td style="text-align:center">0.6193 秒</td><td style="text-align:center">0.3004 秒</td></tr><tr><td style="text-align:center">m=91</td><td style="text-align:center">85.30%</td><td style="text-align:center">55.80%</td><td style="text-align:center">2.30%</td><td style="text-align:center">1.10%</td></tr><tr><td style="text-align:center">n=3</td><td style="text-align:center">0.1846 秒</td><td style="text-align:center">0.0302 秒</td><td style="text-align:center">0.6270 秒</td><td style="text-align:center">0.6093 秒</td></tr><tr><td style="text-align:center">m=92</td><td style="text-align:center">87.70%</td><td style="text-align:center">55.70%</td><td style="text-align:center">3.30%</td><td style="text-align:center">1.20%</td></tr><tr><td style="text-align:center">n=3</td><td style="text-align:center">0.1869 秒</td><td style="text-align:center">0.0308 秒</td><td style="text-align:center">0.6365 秒</td><td style="text-align:center">0.4806 秒</td></tr><tr><td style="text-align:center">m=93</td><td style="text-align:center">90.20%</td><td style="text-align:center">58.60%</td><td style="text-align:center">3.70%</td><td style="text-align:center">1.20%</td></tr><tr><td style="text-align:center">n=3</td><td style="text-align:center">0.1870 秒</td><td style="text-align:center">0.0309 秒</td><td style="text-align:center">0.6299 秒</td><td style="text-align:center">0.5702 秒</td></tr></tbody></table><p align="center"><b>表2 中噪下不同的方法选取不同的条数实验结果</b></p><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">CPA</th><th style="text-align:center">DPA（随机选取 m*n 条）</th><th style="text-align:center">MIA</th><th style="text-align:center">PDF</th></tr></thead><tbody><tr><td style="text-align:center">m=110</td><td style="text-align:center">81.20%</td><td style="text-align:center">53.70%</td><td style="text-align:center">1.30%</td><td style="text-align:center">0.30%</td></tr><tr><td style="text-align:center">n=4</td><td style="text-align:center">0.2016 秒</td><td style="text-align:center">0.0462 秒</td><td style="text-align:center">0.8261 秒</td><td style="text-align:center">4.2723 秒</td></tr><tr><td style="text-align:center">m=120</td><td style="text-align:center">86.60%</td><td style="text-align:center">58.80%</td><td style="text-align:center">1.60%</td><td style="text-align:center">0.30%</td></tr><tr><td style="text-align:center">n=4</td><td style="text-align:center">0.2029 秒</td><td style="text-align:center">0.0496 秒</td><td style="text-align:center">0.9163 秒</td><td style="text-align:center">4.8732 秒</td></tr><tr><td style="text-align:center">m=130</td><td style="text-align:center">89.60%</td><td style="text-align:center">62.50%</td><td style="text-align:center">1.80%</td><td style="text-align:center">0.040%</td></tr><tr><td style="text-align:center">n=4</td><td style="text-align:center">0.2093 秒</td><td style="text-align:center">0.0524 秒</td><td style="text-align:center">0.9075 秒</td><td style="text-align:center">5.1960 秒</td></tr><tr><td style="text-align:center">m=140</td><td style="text-align:center">91.50%</td><td style="text-align:center">62.50%</td><td style="text-align:center">1.80%</td><td style="text-align:center">0.50%</td></tr><tr><td style="text-align:center">n=4</td><td style="text-align:center">0.2141 秒</td><td style="text-align:center">0.0540 秒</td><td style="text-align:center">0.9851 秒</td><td style="text-align:center">5.3591 秒</td></tr></tbody></table><p align="center"><b>表3 高噪下不同的方法选取不同的条数实验结果</b></p><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">CPA</th><th style="text-align:center">DPA（随机选取 m*n 条）</th><th style="text-align:center">MIA</th><th style="text-align:center">PDF</th></tr></thead><tbody><tr><td style="text-align:center">m=160</td><td style="text-align:center">86.50%</td><td style="text-align:center">46.60%</td><td style="text-align:center">1.50%</td><td style="text-align:center">0.40%</td></tr><tr><td style="text-align:center">n=10</td><td style="text-align:center">0.2910 秒</td><td style="text-align:center">0.1371 秒</td><td style="text-align:center">2.2840 秒</td><td style="text-align:center">10.9931 秒</td></tr><tr><td style="text-align:center">m=170</td><td style="text-align:center">87.20%</td><td style="text-align:center">48.40%</td><td style="text-align:center">1.50%</td><td style="text-align:center">0.50%</td></tr><tr><td style="text-align:center">n=10</td><td style="text-align:center">0.3009 秒</td><td style="text-align:center">0.1447 秒</td><td style="text-align:center">2.5422 秒</td><td style="text-align:center">13.3591 秒</td></tr><tr><td style="text-align:center">m=175</td><td style="text-align:center">89.00%</td><td style="text-align:center">52.20%</td><td style="text-align:center">1.60%</td><td style="text-align:center">0.50%</td></tr><tr><td style="text-align:center">n=10</td><td style="text-align:center">0.3058 秒</td><td style="text-align:center">0.1484 秒</td><td style="text-align:center">2.8413 秒</td><td style="text-align:center">15.6790 秒</td></tr><tr><td style="text-align:center">m=180</td><td style="text-align:center">90.70%</td><td style="text-align:center">52.80%</td><td style="text-align:center">1.70%</td><td style="text-align:center">0.60%</td></tr><tr><td style="text-align:center">n=10</td><td style="text-align:center">0.3068 秒</td><td style="text-align:center">0.1543 秒</td><td style="text-align:center">3.6823 秒</td><td style="text-align:center">16.3692 秒</td></tr><tr><td style="text-align:center">m=190</td><td style="text-align:center">93.30%</td><td style="text-align:center">56.60%</td><td style="text-align:center">1.80%</td><td style="text-align:center">0.50%</td></tr><tr><td style="text-align:center">n=10</td><td style="text-align:center">0.3166 秒</td><td style="text-align:center">0.1596 秒</td><td style="text-align:center">3.9538 秒</td><td style="text-align:center">17.5860 秒</td></tr></tbody></table><p>从中我们可以发现，采用这种数据处理方法之后，CPA的实现效果在四种方法中达到最好，因此对于CPA我们还进行了多次数据尝试，具体结果如下图所示：</p><p align="center"><b>表 4 固定 n=2 时 CPA 所得成功率</b></p><table><thead><tr><th style="text-align:center">m</th><th style="text-align:center">n</th><th style="text-align:center">num</th><th style="text-align:center">成功率</th></tr></thead><tbody><tr><td style="text-align:center">130</td><td style="text-align:center">2</td><td style="text-align:center">260</td><td style="text-align:center">86.6</td></tr><tr><td style="text-align:center">135</td><td style="text-align:center">2</td><td style="text-align:center">270</td><td style="text-align:center">86.7</td></tr><tr><td style="text-align:center">140</td><td style="text-align:center">2</td><td style="text-align:center">280</td><td style="text-align:center">89.2</td></tr><tr><td style="text-align:center">145</td><td style="text-align:center">2</td><td style="text-align:center">290</td><td style="text-align:center">90.3</td></tr><tr><td style="text-align:center">150</td><td style="text-align:center">2</td><td style="text-align:center">300</td><td style="text-align:center">90.4</td></tr><tr><td style="text-align:center">155</td><td style="text-align:center">2</td><td style="text-align:center">310</td><td style="text-align:center">91.6</td></tr></tbody></table><p align="center"><b>表 5 固定 n=3 时 CPA 所得成功率</b></p><table><thead><tr><th style="text-align:center">m</th><th style="text-align:center">n</th><th style="text-align:center">num</th><th style="text-align:center">成功率</th></tr></thead><tbody><tr><td style="text-align:center">90</td><td style="text-align:center">3</td><td style="text-align:center">270</td><td style="text-align:center">85.9</td></tr><tr><td style="text-align:center">95</td><td style="text-align:center">3</td><td style="text-align:center">285</td><td style="text-align:center">88.1</td></tr><tr><td style="text-align:center">100</td><td style="text-align:center">3</td><td style="text-align:center">300</td><td style="text-align:center">90.1</td></tr><tr><td style="text-align:center">105</td><td style="text-align:center">3</td><td style="text-align:center">315</td><td style="text-align:center">90.1</td></tr><tr><td style="text-align:center">115</td><td style="text-align:center">3</td><td style="text-align:center">345</td><td style="text-align:center">95</td></tr></tbody></table><p align="center"><b>表 6 固定 n=4 时 CPA 所得成功率</b></p><table><thead><tr><th style="text-align:center">m</th><th style="text-align:center">n</th><th style="text-align:center">num</th><th style="text-align:center">成功率</th></tr></thead><tbody><tr><td style="text-align:center">70</td><td style="text-align:center">4</td><td style="text-align:center">280</td><td style="text-align:center">82.7</td></tr><tr><td style="text-align:center">74</td><td style="text-align:center">4</td><td style="text-align:center">296</td><td style="text-align:center">85.9</td></tr><tr><td style="text-align:center">76</td><td style="text-align:center">4</td><td style="text-align:center">304</td><td style="text-align:center">87</td></tr><tr><td style="text-align:center">78</td><td style="text-align:center">4</td><td style="text-align:center">312</td><td style="text-align:center">89.6</td></tr><tr><td style="text-align:center">80</td><td style="text-align:center">4</td><td style="text-align:center">320</td><td style="text-align:center">90.5</td></tr><tr><td style="text-align:center">82</td><td style="text-align:center">4</td><td style="text-align:center">328</td><td style="text-align:center">90.9</td></tr></tbody></table><p align="center"><b>表 7 固定 n=5 时 CPA 所得成功率</b></p><table><thead><tr><th style="text-align:center">m</th><th style="text-align:center">n</th><th style="text-align:center">num</th><th style="text-align:center">成功率</th></tr></thead><tbody><tr><td style="text-align:center">60</td><td style="text-align:center">5</td><td style="text-align:center">300</td><td style="text-align:center">85.4</td></tr><tr><td style="text-align:center">65</td><td style="text-align:center">5</td><td style="text-align:center">325</td><td style="text-align:center">88.8</td></tr><tr><td style="text-align:center">67</td><td style="text-align:center">5</td><td style="text-align:center">335</td><td style="text-align:center">89</td></tr><tr><td style="text-align:center">68</td><td style="text-align:center">5</td><td style="text-align:center">340</td><td style="text-align:center">90.8</td></tr><tr><td style="text-align:center">70</td><td style="text-align:center">5</td><td style="text-align:center">350</td><td style="text-align:center">91.7</td></tr></tbody></table></div></div><div class="post-meta"><i><span>2025-10-28</span> <span>该篇文章被 黄璇</span> <span>打上标签: <a href="/tags/CTF/">CTF </a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全 </a><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学 </a></span><span>归为分类: <a href="/categories/CTF/">CTF</a></span></i></div><br><div class="post-footer-pre-next"><span class="post-footer-pre-next-last-span-right">下一篇：<a href="/:nsa_time.html">看懂&#34;授时中心被黑&#34;的整件事：一条从手机到电脑的隐蔽渗透链</a></span></div><div class="comments-container"><div id="comment-anchor"></div><div class="comment-area-title"></div><div id="giscus"></div><script src="https://giscus.app/client.js" data-repo="inwpu/inwpu.github.io" data-repo-id="R_kgDOPMI8LA" data-category="General" data-category-id="DIC_kwDOPMI8LM4CtWwu" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="fro" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async></script></div></div><div class="footer"><span>© 1949-2025 ainwpu</span></div><div class="footer-last"><span></span></div><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "e5317d9548244f8a9c52f472cfcea521"}'></script><div id="site-runtime">本人已坚强开机运行 <span id="runtime-text"></span> <span id="heartbeat">❤️</span></div><style>#site-runtime{text-align:center;font-size:14px;margin-top:20px;color:#888}#heartbeat{display:inline-block;color:red;font-size:16px;animation:none;transform-origin:center}@keyframes beat{0%{transform:scale(1)}25%{transform:scale(1.3)}50%{transform:scale(1)}}</style><script>const startTime=new Date("2000-10-29T00:00:00");function updateRuntime(){const e=new Date-startTime,t=`${Math.floor(e/864e5)} 天 ${Math.floor(e/36e5%24)} 时 ${Math.floor(e/6e4%60)} 分 ${Math.floor(e/1e3%60)} 秒`;document.getElementById("runtime-text").innerText=t;const n=document.getElementById("heartbeat");n.style.animation="beat 0.3s ease",setTimeout(()=>{n.style.animation="none"},300)}updateRuntime(),setInterval(updateRuntime,1e3)</script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript"></script><script src="/js/toc.js"></script><script src="/js/randomHeaderContent.js"></script><script src="/js/returnToTop.js"></script><script src="/js/returnToLastPage.js"></script><script src="/js/lightgallery/lightgallery.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script><script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script><script src="/js/particles.js"></script></div><script type="text/javascript">if("undefined"!=typeof lightGallery){var options1={selector:".gallery-item",plugins:[lgThumbnail,lgFullscreen,lgAutoplay,lgZoom,lgRotate,lgPager],thumbnail:!0,zoom:!0,rotate:!0,autoplay:!0,fullScreen:!0,pager:!1,zoomFromOrigin:!0,actualSize:!0,enableZoomAfter:300};lightGallery(document.getElementsByClassName(".article-gallery")[0],options1)}</script></div><div class="progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div><div class="return-to-last-progress-wrap shadow-drop-2-bottom"><svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102"><path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/></svg></div><div id="site-stats-float" class="glass visible"><ul><li>📄 文章数目：5</li><li>👥 本站访客数：<span id="busuanzi_container_site_uv" style="display:inline"><span id="busuanzi_value_site_uv">加载中...</span></span></li><li>📊 总浏览量：<span id="busuanzi_container_site_pv" style="display:inline"><span id="busuanzi_value_site_pv">加载中...</span></span></li><li>🆔 访客识别码：<span id="visitor-id">加载中...</span></li><li>⏱ 页面停留：<span id="stay-time">0 秒</span></li><li>🌐 IP：<span id="ip">加载中...</span></li><li>🌍 国家：<span id="country">加载中...</span></li><li>🏙 城市：<span id="city">加载中...</span></li><li>💼 运营商：<span id="org">加载中...</span></li><li>💻 系统：<span id="os">加载中...</span></li><li>🌐 浏览器：<span id="browser">加载中...</span></li><li>📱 设备：<span id="device">加载中...</span></li><li>📐 屏幕分辨率：<span id="screen-res">加载中...</span></li><li>🌏 语言偏好：<span id="language">加载中...</span></li><li>🕐 时区：<span id="timezone">加载中...</span></li><li>🎨 色彩深度：<span id="color-depth">加载中...</span></li><li>🔗 来源页面：<span id="referrer">加载中...</span></li><li>📶 网络状态：<span id="connection">加载中...</span></li><li>⏰ 当前时间：<span id="nowtime">加载中...</span></li><li>📅 页面更新：10/29/2025, 9:38:11 AM</li></ul></div><style>#site-stats-float{position:fixed!important;bottom:20px!important;right:20px!important;padding:20px 24px;max-width:340px;max-height:80vh;overflow-y:auto;font-size:13px;border-radius:20px;backdrop-filter:blur(40px) saturate(180%);-webkit-backdrop-filter:blur(40px) saturate(180%);background:rgba(255,255,255,.72);border:.5px solid rgba(255,255,255,.8);box-shadow:0 8px 32px rgba(0,0,0,.12),0 2px 8px rgba(0,0,0,.08),inset 0 1px 1px rgba(255,255,255,.9);color:#1d1d1f;z-index:10000!important;line-height:1.7;transition:opacity .6s cubic-bezier(.4,0,.2,1),transform .6s cubic-bezier(.4,0,.2,1);will-change:opacity,transform}#site-stats-float.fade-out{opacity:0;transform:translateY(10px);pointer-events:none}#site-stats-float::-webkit-scrollbar{width:6px}#site-stats-float::-webkit-scrollbar-track{background:rgba(255,255,255,.1);border-radius:3px}#site-stats-float::-webkit-scrollbar-thumb{background:rgba(0,0,0,.2);border-radius:3px}#site-stats-float::-webkit-scrollbar-thumb:hover{background:rgba(0,0,0,.3)}#site-stats-float ul{padding:0;margin:0}#site-stats-float li{list-style:none;margin-bottom:6px;word-break:break-word}</style><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>function generateUUID(){return"xxxxxx-xxxxxx".replace(/[x]/g,()=>(36*Math.random()|0).toString(36))}function getVisitorID(){let t=localStorage.getItem("visitor_uuid");return t||(t=generateUUID(),localStorage.setItem("visitor_uuid",t)),t}document.getElementById("visitor-id").textContent=getVisitorID();let staySeconds=0;const stayEl=document.getElementById("stay-time");function formatTime(t){const e=Math.floor(t/60);return(e>0?e+" 分 ":"")+t%60+" 秒"}function getSystemInfo(){const t=navigator.userAgent;let e="未知系统",n="未知浏览器",o=/Mobile|Android|iP(hone|od|ad)/.test(t)?"移动设备":"桌面设备";/Windows NT/.test(t)?e="Windows":/Mac OS X/.test(t)?e="macOS":/Android/.test(t)?e="Android":/iPhone|iPad|iPod/.test(t)?e="iOS":/Linux/.test(t)&&(e="Linux"),/Chrome\/([\d.]+)/.test(t)?n="Chrome "+t.match(/Chrome\/([\d.]+)/)[1]:/Firefox\/([\d.]+)/.test(t)?n="Firefox "+t.match(/Firefox\/([\d.]+)/)[1]:/Safari\/([\d.]+)/.test(t)&&!/Chrome/.test(t)?n="Safari":/Edg\/([\d.]+)/.test(t)&&(n="Edge "+t.match(/Edg\/([\d.]+)/)[1]),document.getElementById("os").textContent=e,document.getElementById("browser").textContent=n,document.getElementById("device").textContent=o}function updateTime(){const t=new Date;document.getElementById("nowtime").textContent=t.toLocaleString()}setInterval(()=>{staySeconds++,stayEl.textContent=formatTime(staySeconds)},1e3),fetch("https://ipapi.co/json/").then(t=>t.json()).then(t=>{document.getElementById("ip").textContent=t.ip,document.getElementById("country").textContent=t.country_name,document.getElementById("city").textContent=t.city,document.getElementById("org").textContent=t.org}).catch(()=>{document.getElementById("ip").textContent="获取失败"}),getSystemInfo(),updateTime(),setInterval(updateTime,1e3),document.getElementById("screen-res").textContent=screen.width+" × "+screen.height,document.getElementById("language").textContent=navigator.language||navigator.userLanguage||"未知";const timezone=Intl.DateTimeFormat().resolvedOptions().timeZone;document.getElementById("timezone").textContent=timezone||"未知",document.getElementById("color-depth").textContent=screen.colorDepth+" 位";const referrer=document.referrer||"直接访问";function updateConnectionStatus(){const t=navigator.onLine?"在线":"离线";let e="未知";if(navigator.connection||navigator.mozConnection||navigator.webkitConnection){const t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;let n=t.effectiveType||t.type||"未知";e="4g"===n&&t.downlink&&t.downlink>50?"5G (高速)":"4g"===n?t.downlink&&t.downlink>20?"4G/5G":"4G":"3g"===n?"3G":"2g"===n?"2G":"slow-2g"===n?"慢速 2G":n.toUpperCase(),t.downlink&&(e+=` (${t.downlink.toFixed(1)} Mbps)`)}document.getElementById("connection").textContent=t+" - "+e}document.getElementById("referrer").textContent=""===referrer?"直接访问":referrer.length>30?referrer.substring(0,30)+"...":referrer,updateConnectionStatus(),window.addEventListener("online",updateConnectionStatus),window.addEventListener("offline",updateConnectionStatus),setTimeout(()=>{const t=document.getElementById("site-stats-float");t&&t.classList.add("fade-out")},1e4)</script></body></html><script src="/js/emojiHandler.js"></script><script>document.addEventListener("DOMContentLoaded",()=>{wrapEmojis(".paper")})</script><script src="/js/hackerTerminal.js"></script>