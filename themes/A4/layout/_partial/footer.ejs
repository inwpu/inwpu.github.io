<div class="footer">
    <% if(path != 'index.html') { %>
        <span>
            <%= theme.footerLink.info %>

            <% for (name in theme.footerLink) { %>
                <% if(name != 'info') { %>
                    / <a href="<%- url_for(theme.footerLink[name]) %>"> <%= name %> </a>
                <% } %>

            <% } %>
        </span>

    <% } %>
</div>

<% if(path == 'index.html' && (theme.indexInfo.allWordCount || theme.indexInfo.allViewCount)){ %>
<div class="footer-last-without-line">
    <% if(theme.indexInfo.allWordCount) { %>
        <span>æœ¬ç«™æ€»å­—æ•°ï¼š<%= totalcount(site) %></span>
    <% } %>
    <% if(theme.indexInfo.allWordCount && theme.indexInfo.allViewCount) { %>
    <div class="footer-last-span-right">
        <% } else if(!theme.indexInfo.allWordCount && theme.indexInfo.allViewCount) { %>
        <div>
            <% } %>
            <% if(theme.indexInfo.allViewCount) { %>
                <span id="busuanzi_container_site_pv" class="">
                    æœ¬ç«™æ€»è®¿é—®ï¼š<span id="busuanzi_value_site_pv"></span>æ¬¡
                </span>
        </div>
        <% } %>
    </div>
    <% } %>

    <!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
    <div class="footer-last">
        <% if(path == 'index.html'){ %>
            <% if(theme.index.footer != null || theme.index.footer != "") { %>
                <% if(theme.index.footer.length > "Email:".length && theme.index.footer.substring(0, 6) == "Email:") { %>
                    <% var email = theme.index.footer.substring(6, theme.index.footer.length) %>
                    <span class="index-footer-last-span">Email:<%- mail_to(email) %></span>
                <% } else { %>
                    <span class="index-footer-last-span"><%= theme.index.footer %></span>
                <% } %>
            <% } %>
        <% } else { %>
            <span><%= theme.post.footer %></span>
            <% if(theme.post.themeInfo) { %>
                <span class="footer-last-span-right"><i>æœ¬ç«™ç”±<a href="https://hexo.io/zh-cn/index.html">Hexo</a>é©±åŠ¨ï½œä½¿ç”¨<a href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>ä¸»é¢˜</i></span>
            <% } %>
        <% } %>
    </div>
    <!-- Cloudflare Web Analytics -->
    <script defer src='https://static.cloudflareinsights.com/beacon.min.js'
            data-cf-beacon='{"token": "e5317d9548244f8a9c52f472cfcea521"}'></script>
    <!-- End Cloudflare Web Analytics -->
    <!-- ç«™ç‚¹è¿è¡Œæ—¶é—´æ¨¡å—ï¼ˆæ‰€æœ‰é¡µé¢éƒ½æ˜¾ç¤ºï¼‰ -->
    <div id="site-runtime">
        æœ¬äººå·²åšå¼ºå¼€æœºè¿è¡Œ <span id="runtime-text"></span> <span id="heartbeat">â¤ï¸</span>
    </div>

    <style>
        #site-runtime {
            text-align: center;
            font-size: 14px;
            margin-top: 20px;
            color: #888;
        }

        #heartbeat {
            display: inline-block;
            color: red;
            font-size: 16px;
            animation: none;
            transform-origin: center;
        }

        @keyframes beat {
            0% { transform: scale(1); }
            25% { transform: scale(1.3); }
            50% { transform: scale(1); }
        }
    </style>

    <script>
        const startTime = new Date("2000-10-29T00:00:00"); // â† æ›¿æ¢ä¸ºä½ å»ºç«™æ—¶é—´
        function updateRuntime() {
            const now = new Date();
            const diff = now - startTime;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const minutes = Math.floor((diff / (1000 * 60)) % 60);
            const seconds = Math.floor((diff / 1000) % 60);
            const timeStr = `${days} å¤© ${hours} æ—¶ ${minutes} åˆ† ${seconds} ç§’`;
            document.getElementById("runtime-text").innerText = timeStr;

            const heart = document.getElementById("heartbeat");
            heart.style.animation = "beat 0.3s ease";
            setTimeout(() => {
                heart.style.animation = "none";
            }, 300);
        }
        updateRuntime();
        setInterval(updateRuntime, 1000);
    </script>

    <% if(theme.cdn.enable) { %>
        <% if(theme.cdn.choose == "aliyun") { %>
            <%- js('https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/highlight.min.js') %>
            <%- js('https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/highlightjs-line-numbers.js') %>

            <%- js('js/randomHeaderContent.js') %>
            <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
            <% if(theme.tool.returnToTop) { %>
                <%- js('https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js') %>
                <%- js('https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/returnToTop.js') %>
            <% } %>

            <!--ç›®å½•-->
            <% if(theme.tool.leftToc) { %>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
                <%- js('https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/toc.js') %>
            <% } %>
        <% } else if(theme.cdn.choose == "zzko") { %>
            <%- js('https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/js/highlight.min.js') %>
            <%- js('https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/js/highlightjs-line-numbers.js') %>

            <%- js('https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/js/randomHeaderContent.js') %>
            <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
            <% if(theme.tool.returnToTop) { %>
                <%- js('https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js') %>
                <%- js('https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/js/returnToTop.js') %>
            <% } %>

            <!--ç›®å½•-->
            <% if(theme.tool.leftToc) { %>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
                <%- js('https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/js/toc.js') %>
            <% } %>
        <% } else if(theme.cdn.choose == "jsdelivr") { %>
            <%- js('https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/highlight.min.js') %>
            <%- js('https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/highlightjs-line-numbers.js') %>

            <%- js('https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/randomHeaderContent.js') %>
            <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
            <% if(theme.tool.returnToTop) { %>
                <%- js('https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js') %>
                <%- js('https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/returnToTop.js') %>
            <% } %>

            <!--ç›®å½•-->
            <% if(theme.tool.leftToc) { %>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
                <%- js('https://jsd.onmicrosoft.cn/npm/hexo-theme-a4@latest/source/js/toc.js') %>
            <% } %>
        <% } else if(theme.cdn.choose == "unpkg") { %>
            <%- js('https://npm.onmicrosoft.cn/hexo-theme-a4@latest/source/js/highlight.min.js') %>
            <%- js('https://npm.onmicrosoft.cn/hexo-theme-a4@latest/source/js/highlightjs-line-numbers.js') %>

            <%- js('https://npm.onmicrosoft.cn/hexo-theme-a4@latest/source/js/randomHeaderContent.js') %>
            <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
            <% if(theme.tool.returnToTop) { %>
                <%- js('https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js') %>
                <%- js('https://npm.onmicrosoft.cn/hexo-theme-a4@latest/source/js/returnToTop.js') %>
            <% } %>

            <!--ç›®å½•-->
            <% if(theme.tool.leftToc) { %>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
                <%- js('https://npm.onmicrosoft.cn/hexo-theme-a4@latest/source/js/toc.js') %>
            <% } %>
        <% } %>
    <% } else { %>
        <%- js('https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js') %>
        <!--ç›®å½•-->
        <% if(theme.tool.leftToc) { %>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
            <%- js('js/toc.js') %>
        <% } %>

        <%- js('js/randomHeaderContent.js') %>
        <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
        <% if(theme.tool.returnToTop) { %>
            <%- js('js/returnToTop.js') %>
        <% } %>

        <% if(theme.tool.returnToTop) { %>
            <%- js('js/returnToLastPage.js') %>
        <% } %>

    <% } %>


    <%- js('js/lightgallery/lightgallery.umd.min.js') %>

    <%- js('js/lightgallery/plugins/lg-thumbnail.umd.min.js') %>

    <%- js('js/lightgallery/plugins/lg-fullscreen.umd.min.js') %>
    <%- js('js/lightgallery/plugins/lg-autoplay.umd.min.js') %>
    <%- js('js/lightgallery/plugins/lg-zoom.umd.min.js') %>
    <%- js('js/lightgallery/plugins/lg-rotate.umd.min.js') %>
    <%- js('js/lightgallery/plugins/lg-paper.umd.min.js') %>
    <!-- ğŸŒ è®¿å®¢ä¿¡æ¯æµ®åŠ¨æ¡†ï¼ˆç»ç’ƒæ‹Ÿæ€ + å¯æŠ˜å ï¼‰ -->
    <div id="site-stats-float" class="glass visible">
        <ul>
            <li>ğŸ“„ æ–‡ç« æ•°ç›®ï¼š<%= site.posts.length %></li>
            <li>ğŸ‘¥ æœ¬ç«™è®¿å®¢æ•°ï¼š<span id="busuanzi_value_site_uv">åŠ è½½ä¸­...</span></li>
            <li>ğŸ“Š æ€»æµè§ˆé‡ï¼š<span id="busuanzi_value_site_pv">åŠ è½½ä¸­...</span></li>
            <li>ğŸ†” è®¿å®¢è¯†åˆ«ç ï¼š<span id="visitor-id">åŠ è½½ä¸­...</span></li>
            <li>â± é¡µé¢åœç•™ï¼š<span id="stay-time">0 ç§’</span></li>
            <li>ğŸŒ IPï¼š<span id="ip">åŠ è½½ä¸­...</span></li>
            <li>ğŸŒ å›½å®¶ï¼š<span id="country">åŠ è½½ä¸­...</span></li>
            <li>ğŸ™ åŸå¸‚ï¼š<span id="city">åŠ è½½ä¸­...</span></li>
            <li>ğŸ’¼ è¿è¥å•†ï¼š<span id="org">åŠ è½½ä¸­...</span></li>
            <li>ğŸ’» ç³»ç»Ÿï¼š<span id="os">åŠ è½½ä¸­...</span></li>
            <li>ğŸŒ æµè§ˆå™¨ï¼š<span id="browser">åŠ è½½ä¸­...</span></li>
            <li>ğŸ“± è®¾å¤‡ï¼š<span id="device">åŠ è½½ä¸­...</span></li>
            <li>â° å½“å‰æ—¶é—´ï¼š<span id="nowtime">åŠ è½½ä¸­...</span></li>
            <li>ğŸ“… é¡µé¢æ›´æ–°ï¼š<%= new Date().toLocaleString() %></li>
        </ul>
    </div>
</div>
<!-- ğŸ’„ æ ·å¼ -->
<style>
    #site-stats-float {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.95);
        border: 1px solid #ccc;
        border-radius: 10px;
        padding: 14px 18px;
        font-size: 13px;
        color: #222;
        box-shadow: 0 0 10px rgba(0,0,0,0.15);
        z-index: 9999;
        line-height: 1.6;
        max-width: 300px;
    }
    #site-stats-float li {
        list-style: none;
    }
    /* ğŸŒ«ï¸ æ¯›ç»ç’ƒç»ç’ƒæ‹Ÿæ€é£æ ¼ */
    #site-stats-float.glass {
        position: fixed;
        bottom: 20px;
        right: 20px;
        padding: 16px 20px;
        max-width: 300px;
        font-size: 13px;
        border-radius: 16px;
        backdrop-filter: blur(12px);
        background: rgba(255, 255, 255, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        color: #222;
        z-index: 9999;
        line-height: 1.6;
        transition: opacity 0.3s ease, transform 0.3s ease;
    }

    #site-stats-float ul {
        padding: 0;
        margin: 0;
    }
    #site-stats-float li {
        list-style: none;
        margin-bottom: 6px;
    }
</style>


<!-- ğŸš€ è„šæœ¬ -->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script>
    // UUID
    function generateUUID() {
        return 'xxxxxx-xxxxxx'.replace(/[x]/g, () =>
            (Math.random() * 36 | 0).toString(36)
        );
    }

    function getVisitorID() {
        let id = localStorage.getItem('visitor_uuid');
        if (!id) {
            id = generateUUID();
            localStorage.setItem('visitor_uuid', id);
        }
        return id;
    }

    document.getElementById('visitor-id').textContent = getVisitorID();

    // åœç•™æ—¶é—´
    let staySeconds = 0;
    const stayEl = document.getElementById('stay-time');
    function formatTime(s) {
        const m = Math.floor(s / 60), sec = s % 60;
        return (m > 0 ? m + ' åˆ† ' : '') + sec + ' ç§’';
    }
    setInterval(() => {
        staySeconds++;
        stayEl.textContent = formatTime(staySeconds);
    }, 1000);

    // IP ä¿¡æ¯
    fetch('https://ipapi.co/json/')
        .then(res => res.json())
        .then(data => {
            document.getElementById('ip').textContent = data.ip;
            document.getElementById('country').textContent = data.country_name;
            document.getElementById('city').textContent = data.city;
            document.getElementById('org').textContent = data.org;
        })
        .catch(() => {
            document.getElementById('ip').textContent = 'è·å–å¤±è´¥';
        });

    // ç³»ç»Ÿä¿¡æ¯
    function getSystemInfo() {
        const ua = navigator.userAgent;
        let os = 'æœªçŸ¥ç³»ç»Ÿ', browser = 'æœªçŸ¥æµè§ˆå™¨', device = /Mobile|Android|iP(hone|od|ad)/.test(ua) ? 'ç§»åŠ¨è®¾å¤‡' : 'æ¡Œé¢è®¾å¤‡';
        if (/Windows NT/.test(ua)) os = 'Windows';
        else if (/Mac OS X/.test(ua)) os = 'macOS';
        else if (/Android/.test(ua)) os = 'Android';
        else if (/iPhone|iPad|iPod/.test(ua)) os = 'iOS';
        else if (/Linux/.test(ua)) os = 'Linux';

        if (/Chrome\/([\d.]+)/.test(ua)) browser = 'Chrome ' + ua.match(/Chrome\/([\d.]+)/)[1];
        else if (/Firefox\/([\d.]+)/.test(ua)) browser = 'Firefox ' + ua.match(/Firefox\/([\d.]+)/)[1];
        else if (/Safari\/([\d.]+)/.test(ua) && !/Chrome/.test(ua)) browser = 'Safari';
        else if (/Edg\/([\d.]+)/.test(ua)) browser = 'Edge ' + ua.match(/Edg\/([\d.]+)/)[1];

        document.getElementById('os').textContent = os;
        document.getElementById('browser').textContent = browser;
        document.getElementById('device').textContent = device;
    }

    getSystemInfo();

    // å½“å‰æ—¶é—´
    function updateTime() {
        const now = new Date();
        document.getElementById('nowtime').textContent = now.toLocaleString();
    }
    updateTime();
    setInterval(updateTime, 1000);
    // ğŸŒŸ æ”¶èµ· / å±•å¼€æ§åˆ¶
    function toggleStats() {
        const statsBox = document.getElementById('site-stats-float');
        statsBox.classList.toggle('hidden');
    }

</script>


<script type="text/javascript">

    if (typeof lightGallery !== "undefined") {
        var options1 = {
            selector: '.gallery-item',
            plugins: [lgThumbnail, lgFullscreen, lgAutoplay, lgZoom, lgRotate, lgPager], // å¯ç”¨æ’ä»¶
            thumbnail: <%= theme.lightgallery.thumbnail %>,          // æ˜¾ç¤ºç¼©ç•¥å›¾
            zoom: <%= theme.lightgallery.zoom %>,               // å¯ç”¨ç¼©æ”¾åŠŸ
            rotate: <%= theme.lightgallery.rotate %>,             // å¯ç”¨æ—‹è½¬åŠŸèƒ½èƒ½
            autoplay: <%= theme.lightgallery.autoplay %>,        // å¯ç”¨è‡ªåŠ¨æ’­æ”¾åŠŸèƒ½
            fullScreen: <%= theme.lightgallery.fullScreen %>,      // å¯ç”¨å…¨å±åŠŸèƒ½
            pager: <%= theme.lightgallery.pager %>, //é¡µç ,
            zoomFromOrigin: true,   // ä»åŸå§‹ä½ç½®ç¼©æ”¾
            actualSize: true,       // å¯ç”¨æŸ¥çœ‹å®é™…å¤§å°çš„åŠŸèƒ½
            enableZoomAfter: 300,    // å»¶è¿Ÿç¼©æ”¾ï¼Œç¡®ä¿å›¾ç‰‡åŠ è½½å®Œæˆåå¯ç¼©æ”¾
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1); // ä¿®å¤é€‰æ‹©å™¨
    }

</script>

<% if(theme.postInfo.viewCount) { %>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<% } %>